---
title: NEAR वर सबग्राफ तयार करणे
---

> ग्राफ नोडमध्ये आणि होस्ट केलेल्या सेवेवर निअर सपोर्ट बीटामध्ये आहे: जवळचे सबग्राफ बनवण्याबाबत कोणतेही प्रश्न असल्यास कृपया near@thegraph.com शी संपर्क साधा!

हे मार्गदर्शक [जवळच्या ब्लॉकचेन](https://docs.near.org/) वर स्मार्ट कॉन्ट्रॅक्ट्स अनुक्रमित करणारे सबग्राफ तयार करण्यासाठी एक परिचय आहे.

## जवळ म्हणजे काय?

[NEAR](https://near.org/) विकेंद्रित अनुप्रयोग तयार करण्यासाठी एक स्मार्ट कॉन्ट्रॅक्ट प्लॅटफॉर्म आहे. अधिक माहितीसाठी [अधिकृत दस्तऐवज](https://docs.near.org/docs/concepts/new-to-near) ला भेट द्या.

## NEAR subgraphs म्हणजे काय?

ग्राफ डेव्हलपरला ब्लॉकचेन इव्हेंट्सवर प्रक्रिया करण्यासाठी आणि परिणामी डेटा ग्राफक्यूएल API द्वारे सहज उपलब्ध करण्यासाठी साधने देतो, जो वैयक्तिकरित्या सबग्राफ म्हणून ओळखला जातो. [ग्राफ नोड](https://github.com/graphprotocol/graph-node) आता जवळच्या इव्हेंटवर प्रक्रिया करण्यास सक्षम आहे, याचा अर्थ असा की NEAR डेव्हलपर आता त्यांचे स्मार्ट करार अनुक्रमित करण्यासाठी सबग्राफ तयार करू शकतात.

सबग्राफ इव्हेंट-आधारित असतात, याचा अर्थ ते ऐकतात आणि नंतर ऑन-चेन इव्हेंटवर प्रक्रिया करतात. सध्या जवळच्या सबग्राफसाठी दोन प्रकारचे हँडलर समर्थित आहेत:

- ब्लॉक हँडलर: हे प्रत्येक नवीन ब्लॉकवर चालवले जातात
- पावती हँडलर्स: निर्दिष्ट खात्यावर संदेश कार्यान्वित झाल्यावर प्रत्येक वेळी चालवा

[नजीकच्या दस्तऐवजीकरणातून](https://docs.near.org/docs/concepts/transaction#receipt):

> प्रणालीमध्ये पावती ही एकमेव क्रिया करण्यायोग्य वस्तू आहे. जेव्हा आम्ही जवळच्या प्लॅटफॉर्मवर "व्यवहारावर प्रक्रिया करणे" बद्दल बोलतो, तेव्हा याचा अर्थ शेवटी "पावत्या लागू करणे" असा होतो.

## एक NEAR सबग्राफतयार करणे

`@graphprotocol/graph-cli` हे सबग्राफ तयार करण्यासाठी आणि तैनात करण्यासाठी कमांड-लाइन साधन आहे.

`@graphprotocol/graph-ts` ही सबग्राफ-विशिष्ट प्रकारांची लायब्ररी आहे.

निअर सबग्राफ डेव्हलपमेंटसाठी `ग्राफ-क्ली` वरील आवृत्ती `0.23.0` आणि `0.23.0` वरील आवृत्ती `graph-ts` आवश्यक आहे.

> NEAR सबग्राफ तयार करणे, याची प्रक्रिया इथेरियमवरील सबग्राफ तयार करण्याशी खूप सामान्यतेने सादर करते.

सबग्राफ व्याख्येचे तीन पैलू आहेत:

**subgraph.yaml:** सबग्राफ मॅनिफेस्ट, स्वारस्य असलेल्या डेटा स्रोतांची व्याख्या आणि त्यावर प्रक्रिया कशी करावी. NEAR डेटा स्रोताचा एक नवीन `प्रकार` आहे.

**schema.graphql:** एक स्कीमा फाइल जी तुमच्या सबग्राफसाठी कोणता डेटा संग्रहित केला जातो आणि GraphQL द्वारे त्याची क्वेरी कशी करावी हे परिभाषित करते. जवळच्या सबग्राफसाठी आवश्यकता [विद्यमान दस्तऐवज](/developing/creating-a-subgraph#the-graphql-schema) द्वारे कव्हर केल्या जातात.

**AssemblyScript मॅपिंग:** [AssemblyScript कोड](/developing/assemblyscript-api) जो इव्हेंट डेटामधून तुमच्या स्कीमामध्ये परिभाषित केलेल्या घटकांमध्ये अनुवादित करतो. NEAR समर्थन NEAR-विशिष्ट डेटा प्रकार आणि नवीन JSON पार्सिंग कार्यक्षमता सादर करते.

सबग्राफ विकासादरम्यान दोन प्रमुख आज्ञा आहेत:

```bash
$ ग्राफ codegen # मॅनिफेस्टमध्ये ओळखल्या गेलेल्या स्कीमा फाइलमधून प्रकार व्युत्पन्न करते
$ ग्राफ बिल्ड # असेंबलीस्क्रिप्ट फायलींमधून वेब असेंब्ली तयार करते आणि /बिल्ड फोल्डरमध्ये सर्व सबग्राफ फाइल्स तयार करते
```

### सबग्राफ मॅनिफेस्ट व्याख्या

सबग्राफ मॅनिफेस्ट (`subgraph.yaml`) सबग्राफसाठी डेटा स्रोत, स्वारस्य ट्रिगर आणि त्या ट्रिगरला प्रतिसाद म्हणून चालवल्या जाणार्‍या कार्ये ओळखतो. जवळच्या सबग्राफसाठी उदाहरण सबग्राफ मॅनिफेस्टसाठी खाली पहा:

```yaml
specVersion: 0.0.2
schema:
  file: ./src/schema.graphql # link to the schema file
dataSources:
  - kind: near
    network: near-mainnet
    source:
      account: app.good-morning.near # This data source will monitor this account
      startBlock: 10662188 # Required for NEAR
    mapping:
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      blockHandlers:
        - handler: handleNewBlock # the function name in the mapping file
      receiptHandlers:
        - handler: handleReceipt # the function name in the mapping file
      file: ./src/mapping.ts # link to the file with the Assemblyscript mappings
```

- NEAR subgraphs डेटा स्रोताचा एक नवीन `प्रकार` सादर करतात (`जवळ`)
- `नेटवर्क` होस्टिंग ग्राफ नोडवरील नेटवर्कशी संबंधित असले पाहिजे. होस्ट केलेल्या सेवेवर, NEAR चे मेननेट हे `near-mainnet` आहे आणि NEAR चे testnet हे `near-testnet` आहे
- NEAR डेटा स्रोत पर्यायी `source.account` फील्ड सादर करतात, जो [ शी संबंधित मानवी वाचनीय आयडी आहे. खाते जवळ](https://docs.near.org/docs/concepts/account). हे खाते किंवा उप-खाते असू शकते.
- NEAR डेटा स्रोत पर्यायी पर्यायी `source.accounts` फील्ड सादर करतात, ज्यामध्ये पर्यायी प्रत्यय आणि उपसर्ग असतात. किमान उपसर्ग किंवा प्रत्यय निर्दिष्ट करणे आवश्यक आहे, ते अनुक्रमे मूल्यांच्या सूचीसह सुरू होणाऱ्या किंवा समाप्त होणाऱ्या कोणत्याही खात्याशी जुळतील. खालील उदाहरण जुळेल: `[app|good].*[morning.near|morning.testnet]`. जर फक्त उपसर्ग किंवा प्रत्ययांची यादी आवश्यक असेल तर इतर फील्ड वगळले जाऊ शकते.

```yaml
accounts:
  prefixes:
    - app
    - good
  suffixes:
    - morning.near
    - morning.testnet
```

जवळील डेटा स्रोत दोन प्रकारच्या हँडलरला समर्थन देतात:

- `blockHandlers`: प्रत्येक नवीन NEAR ब्लॉकवर चालवा. कोणतेही `source.account` आवश्यक नाही.
- `receiptHandlers`: डेटा स्रोताचा `source.account` प्राप्तकर्ता आहे अशा प्रत्येक पावतीवर चालवा. लक्षात ठेवा की फक्त अचूक जुळण्यांवर प्रक्रिया केली जाते ([उपखाते](https://docs.near.org/docs/concepts/account#subaccounts) स्वतंत्र डेटा स्रोत म्हणून जोडले जाणे आवश्यक आहे).

### स्कीमा व्याख्या

स्कीमा व्याख्या परिणामी सबग्राफ डेटाबेसची रचना आणि संस्थांमधील संबंधांचे वर्णन करते. हे मूळ डेटा स्रोताचे अज्ञेय आहे. सबग्राफ स्कीमा व्याख्या [येथे](/developing/creating-a-subgraph#the-graphql-schema) अधिक तपशील आहेत.

### असेंबलीस्क्रिप्ट मॅपिंग

इव्हेंटवर प्रक्रिया करण्यासाठी हँडलर [AssemblyScript](https://www.assemblyscript.org/) मध्ये लिहिलेले आहेत.

NEAR अनुक्रमणिका [AssemblyScript API](/developing/assemblyscript-api) मध्ये NEAR-विशिष्ट डेटा प्रकारांचा परिचय देते.

```typescript

class ExecutionOutcome {
      gasBurnt: u64,
      blockHash: Bytes,
      id: Bytes,
      logs: Array<string>,
      receiptIds: Array<Bytes>,
      tokensBurnt: BigInt,
      executorId: string,
  }

class ActionReceipt {
      predecessorId: string,
      receiverId: string,
      id: CryptoHash,
      signerId: string,
      gasPrice: BigInt,
      outputDataReceivers: Array<DataReceiver>,
      inputDataIds: Array<CryptoHash>,
      actions: Array<ActionValue>,
  }

class BlockHeader {
      height: u64,
      prevHeight: u64,// Always zero when version < V3
      epochId: Bytes,
      nextEpochId: Bytes,
      chunksIncluded: u64,
      hash: Bytes,
      prevHash: Bytes,
      timestampNanosec: u64,
      randomValue: Bytes,
      gasPrice: BigInt,
      totalSupply: BigInt,
      latestProtocolVersion: u32,
  }

class ChunkHeader {
      gasUsed: u64,
      gasLimit: u64,
      shardId: u64,
      chunkHash: Bytes,
      prevBlockHash: Bytes,
      balanceBurnt: BigInt,
  }

class Block {
      author: string,
      header: BlockHeader,
      chunks: Array<ChunkHeader>,
  }

class ReceiptWithOutcome {
      outcome: ExecutionOutcome,
      receipt: ActionReceipt,
      block: Block,
  }
```

हे प्रकार ब्लॉक करण्यासाठी पास केले जातात & पावती हाताळणारे:

- ब्लॉक हँडलर्सना एक `ब्लॉक` मिळेल
- पावती हाताळणाऱ्यांना `ReceiptWithOutcome` मिळेल

अन्यथा, उर्वरित [AssemblyScript API](/developing/assemblyscript-api) मॅपिंग अंमलबजावणी दरम्यान जवळच्या सबग्राफ विकसकांसाठी उपलब्ध आहे.

यामध्ये नवीन JSON पार्सिंग फंक्शन समाविष्ट आहे - NEAR वरील लॉग वारंवार स्ट्रिंगिफाइड JSON म्हणून उत्सर्जित केले जातात. एक नवीन `json.fromString(...)`विकासकांना या लॉगवर सहज प्रक्रिया करण्याची अनुमती देण्यासाठी unction [JSON API](/developing/assemblyscript-api#json-api) चा भाग म्हणून उपलब्ध आहे.

## NEAR सबग्राफ डिप्लॉय करण्यासाठी

एकदा तुमच्याकडे अंगभूत सबग्राफ आला की, तो अनुक्रमणिकासाठी ग्राफ नोडवर तैनात करण्याची वेळ आली आहे. जवळचे सबग्राफ कोणत्याही ग्राफ नोडवर तैनात केले जाऊ शकतात `>=v0.26.x` (&अद्याप टॅग केलेली नाही आणि रिलीज केलेली नाही).

ग्राफची होस्ट केलेली सेवा सध्या खालील नेटवर्क नावांसह, बीटामध्ये NEAR mainnet आणि testnet अनुक्रमित करण्यास समर्थन देते:

- `जवळ-मेननेट`
- `जवळ-टेस्टनेट`

होस्ट केलेल्या सेवेवर सबग्राफ तयार करणे आणि उपयोजित करणे याबद्दल अधिक माहिती [येथे](/deploying/deploying-a-subgraph-to-hosted) आढळू शकते.

द्रुत प्राइमर म्हणून - पहिली पायरी म्हणजे तुमचा सबग्राफ "तयार" करणे - हे फक्त एकदाच करणे आवश्यक आहे. होस्ट केलेल्या सेवेवर, हे [तुमच्या डॅशबोर्ड](https://thegraph.com/hosted-service/dashboard) वरून केले जाऊ शकते: "सबग्राफ जोडा".

एकदा तुमचा सबग्राफ तयार झाला की, तुम्ही `graph deploy` CLI कमांड वापरून तुमचा सबग्राफ उपयोजित करू शकता:

```sh
$ ग्राफ तयार करा --node <graph-node-url> सबग्राफ/नाव # स्थानिक ग्राफ नोडवर सबग्राफ तयार करतो (होस्ट केलेल्या सेवेवर, हे UI द्वारे केले जाते)
$ ग्राफ तैनात --node <graph-node-url> --ipfs https://api.thegraph.com/ipfs/ # निर्दिष्ट IPFS एंडपॉइंटवर बिल्ड फाइल्स अपलोड करते आणि नंतर मॅनिफेस्ट IPFS हॅशवर आधारित निर्दिष्ट ग्राफ नोडवर सबग्राफ तैनात करते
```

नोड कॉन्फिगरेशन सबग्राफ कोठे तैनात केले जात आहे यावर अवलंबून असेल.

### होस्ट केलेली सेवा

```sh
graph deploy --node https://api.thegraph.com/deploy/ --ipfs https://api.thegraph.com/ipfs/ --access-token <your-access-token>
```

### स्थानिक आलेख नोड (डीफॉल्ट कॉन्फिगरेशनवर आधारित)

```sh
graph deploy --node http://localhost:8020/ --ipfs http://localhost:5001
```

एकदा तुमचा सबग्राफ तैनात केला गेला की, तो ग्राफ नोडद्वारे अनुक्रमित केला जाईल. तुम्ही सबग्राफवरच क्वेरी करून त्याची प्रगती तपासू शकता:

```graphql
{
  _meta {
    block {
      number
    }
  }
}
```

### स्थानिक ग्राफ नोडशी NEAR चे सूचीकरण करणे

NEAR ची अनुक्रमणिका देणारा आलेख नोड चालवण्यासाठी खालील ऑपरेशनल आवश्यकता आहेत:

- फायरहोस इंस्ट्रुमेंटेशनसह इंडेक्सर फ्रेमवर्क जवळ
- NEAR फायरहोज घटकाज(वळ)
- फायरहोस एंडपॉइंटसह आलेख नोड कॉन्फिगर केले आहे

वरील घटक चालवण्याबाबत आम्ही लवकरच अधिक माहिती देऊ.

## NEAR सबग्राफची क्वेरी करणे

NEAR subgraphs साठी GraphQL एंडपॉइंट विद्यमान API इंटरफेससह स्कीमा व्याख्येद्वारे निर्धारित केला जातो. अधिक माहितीसाठी कृपया [GraphQL API दस्तऐवज](/querying/graphql-api) ला भेट द्या.

## उदाहरणे सबग्राफ

संदर्भासाठी येथे काही उदाहरणे सबग्राफ आहेत:

[NEAR ब्लॉक](https://github.com/graphprotocol/graph-tooling/tree/main/examples/near-blocks)

[NEAR पावत्या](https://github.com/graphprotocol/graph-tooling/tree/main/examples/near-receipts)

## FAQ

### बीटा कसे कार्य करते?

NEAR सपोर्ट बीटामध्ये आहे, याचा अर्थ असा की API मध्ये बदल होऊ शकतात कारण आम्ही एकत्रीकरण सुधारण्यासाठी काम करत आहोत. कृपया near@thegraph.com वर ईमेल करा जेणेकरुन आम्‍ही तुम्‍हाला जवळचे सबग्राफ तयार करण्‍यात मदत करू शकू आणि तुम्‍हाला नवीनतम घडामोडींबद्दल अद्ययावत ठेवू शकू!

### सबग्राफ इंडेक्स NEAR आणि EVM दोन्ही चेन करू शकतो का?

नाही, सबग्राफ केवळ एका साखळी/नेटवर्कमधील डेटा स्रोतांना समर्थन देऊ शकतो.

### सबग्राफ अधिक विशिष्ट ट्रिगरवर प्रतिक्रिया देऊ शकतात?

सध्या, फक्त ब्लॉक आणि पावती ट्रिगर समर्थित आहेत. आम्ही एका निर्दिष्ट खात्यावर फंक्शन कॉलसाठी ट्रिगर तपासत आहोत. आम्‍हाला इव्‍हेंट ट्रिगरला सपोर्ट करण्‍यात देखील रस आहे, एकदा NEAR ला नेटिव्ह इव्‍हेंट सपोर्ट असेल.

### पावती हँडलर खाती आणि त्यांच्या उप-खात्यांसाठी ट्रिगर करतील का?

एखादे `खाते` निर्दिष्ट केले असल्यास, ते फक्त खाते नावाशी जुळेल. `खाती` फील्ड निर्दिष्ट करून उप-खाती जुळवणे शक्य आहे, उदाहरणार्थ, खाती आणि उप-खाती जुळण्यासाठी निर्दिष्ट केलेल्या `प्रत्यय` आणि `उपसर्ग` सह. खालील सर्व `mintbase1.near` उप-खात्यांशी जुळतील:

```yaml
accounts:
  suffixes:
    - mintbase1.near
```

### मॅपिंग दरम्यान NEAR subgraphs NEAR खात्यांना व्ह्यू कॉल करू शकतात?

हे समर्थित नाही. अनुक्रमणिकेसाठी ही कार्यक्षमता आवश्यक आहे का याचे आम्ही मूल्यमापन करत आहोत.

### NEARのサブグラフでデータソーステンプレートを使用できますか?

हे सध्या समर्थित नाही. अनुक्रमणिकेसाठी ही कार्यक्षमता आवश्यक आहे का याचे आम्ही मूल्यमापन करत आहोत.

### イーサリアムのサブグラフでは、「pending」および「current」のバージョンがサポートされていますが、NEARのサブグラフの「pending」バージョンをどのようにデプロイできるでしょうか?

NEARサブグラフの「保留中」機能はまだサポートされていません。その間、異なる「名前付き」サブグラフに新しいバージョンをデプロイし、それがチェーンヘッドと同期された後、主要な「名前付き」サブグラフに再デプロイすることができます。この場合、同じ基礎となるデプロイメントIDを使用するため、メインのサブグラフは即座に同期されます.

### माझा प्रश्न उत्तर दिला नाही, NEAR सबग्राफ तयार करण्यासाठी अधिक मदत कुठे मिळेल?

जर सबग्राफ डेव्हलपमेंटचा सामान्य प्रश्न असेल तर, बाकीच्या [डेव्हलपर दस्तऐवजीकरण](/cookbook/quick-start) मध्ये बरीच माहिती आहे. अन्यथा कृपया [द ग्राफ प्रोटोकॉल डिस्कॉर्ड](https://discord.gg/vtvv7FP) मध्ये सामील व्हा आणि #जवळच्या चॅनेलवर विचारा किंवा near@thegraph.com वर ईमेल करा.

## संदर्भ

- [NEAR विकसक दस्तऐवजीकरण](https://docs.near.org/docs/develop/basics/getting-started)
