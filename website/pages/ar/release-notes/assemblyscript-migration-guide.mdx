---
title: Ø¯Ù„ÙŠÙ„ ØªØ±Ø­ÙŠÙ„ AssemblyScript
---

Ø­ØªÙ‰ Ø§Ù„Ø¢Ù† ØŒ ÙƒØ§Ù†Øª Ø§Ù„ Subgraphs ØªØ³ØªØ®Ø¯Ù… Ø£Ø­Ø¯ [ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† AssemblyScript ](https://github.com/AssemblyScript/assemblyscript/tree/v0.6) (v0.6). Ø£Ø®ÙŠØ±Ù‹Ø§ ØŒ Ø£Ø¶ÙÙ†Ø§ Ø§Ù„Ø¯Ø¹Ù… Ù„Ù€ [ Ø£Ø­Ø¯Ø« Ø¯Ø¹Ù… Ù…ØªØ§Ø­ ](https://github.com/AssemblyScript/assemblyscript/tree/v0.19.10) (v0.19.10)! ğŸ‰

Ø³ÙŠÙ…ÙƒÙ† Ø°Ù„Ùƒ Ù„Ù…Ø·ÙˆØ±ÙŠ Ø§Ù„ Subgraph Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù…ÙŠØ²Ø§Øª Ø£Ø­Ø¯Ø« Ù„Ù„ØºØ© AS ÙˆØ§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©.

ÙŠÙ†Ø·Ø¨Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¹Ù„Ù‰ Ø£ÙŠ Ø´Ø®Øµ ÙŠØ³ØªØ®Ø¯Ù… `graph-cli`/`graph-ts` Ø§Ø¯Ù†Ù‰ Ù…Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø± `0.22.0`. Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ø¥ØµØ¯Ø§Ø±Ù‹Ø§ Ø£Ø¹Ù„Ù‰ Ù…Ù† (Ø£Ùˆ Ù…Ø³Ø§ÙˆÙŠÙ‹Ø§) Ù„Ø°Ù„Ùƒ ØŒ ÙØ£Ù†Øª Ø¨Ø§Ù„ÙØ¹Ù„ ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø¥ØµØ¯Ø§Ø± `0.19.10` Ù…Ù† AssemblyScript ğŸ™‚

> Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ø¹ØªØ¨Ø§Ø±Ù‹Ø§ Ù…Ù† `0.24.0` ØŒ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ¯Ø¹Ù… `grapg-node` ÙƒÙ„Ø§ Ø§Ù„Ø¥ØµØ¯Ø§Ø±ÙŠÙ† ØŒ Ø§Ø¹ØªÙ…Ø§Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ `apiVersion` Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙŠ Subgraph manifest.

## Ù…Ù…ÙŠØ²Ø§Øª

### ÙˆØ¸Ø§Ø¦Ù Ø¬Ø¯ÙŠØ¯Ø©

- ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¢Ù† Ø¥Ù†Ø´Ø§Ø¡ `TypedArray` Ù…Ù† `ArrayBuffer` Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… [new `wrap` static method](https://www.assemblyscript.org/stdlib/typedarray.html#static-members) ([v0.8.1](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.8.1)) Ø¬Ø¯ÙŠØ¯
- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©`String#toUpperCase`, `String#toLowerCase`, `String#localeCompare`and `TypedArray#set` ([v0.9.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.0))
- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù€ x instanceof GenericClass ([v0.9.2](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.2))
- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© `StaticArray<T>` Ù…ØªØºÙŠØ± Ù…ØµÙÙˆÙØ© Ø£ÙƒØ«Ø± ÙƒÙØ§Ø¡Ø©([v0.9.3](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.3))
- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ©`Array<T>#flat` ([v0.10.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.10.0))
- ØªÙ… ØªÙ†ÙÙŠØ°`radix` argument Ø¹Ù„Ù‰ `Number#toString` ([v0.10.1](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.10.1))
- Ø¯Ø¹Ù… Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ÙÙˆØ§ØµÙ„ ÙÙŠ floating point literals ([v0.13.7](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.13.7))
- Ø¯Ø¹Ù… Ø¥Ø¶Ø§ÙÙŠ Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ([ v0.14.0 ](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.14.0))
- Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ù†Ø§Ø¡: `i32/i64/f32/f64.add/sub/mul` ([v0.14.13](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.14.13))
- ØªÙ†ÙÙŠØ° `Array/TypedArray/String#at` ([v0.18.2](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.2))
- Ø¯Ø¹Ù… Ø¥Ø¶Ø§ÙÙŠ Ù„Ù‚ÙˆØ§Ù„Ø¨ literal strings ([v0.18.17](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.17))
- Ø£Ø¶Ù`encodeURI(Component)` Ùˆ `decodeURI(Component)` ([v0.18.27](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.27))
- Ø£Ø¶Ø§ÙØ© `toString`, `toDateString` Ùˆ `toTimeString` Ø¥Ù„Ù‰ `Date` ([v0.18.29](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.29))
- Ø£Ø¶Ø§ÙØ© `toUTCString` Ù„ `Date` ([v0.18.30](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.30))
- Ø£Ø¶Ø§ÙØ© `nonnull/NonNullable` builtin type ([v0.19.2](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.19.2))

### Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª

- Ø¯ÙˆØ§Ù„ `Math` Ù…Ø«Ù„ `exp`, `exp2`, `log`, `log2` Ùˆ `pow` ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ù…ØªØºÙŠØ±Ø§Øª Ø£Ø³Ø±Ø¹ ([v0.9.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.0))
- `Math.mod` ([v0.17.1](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.17.1))Ø£ÙƒØ«Ø± ØªØ­Ø³ÙŠÙ†Ø§
- ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ std Map Ùˆ Set ([v0.17.8](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.17.8))
- Ù‚Ù… Ø¨ØªØ­Ø³ÙŠÙ† Ù‚Ø¯Ø±Ø§Øª Ø§Ø«Ù†ÙŠÙ† ÙÙŠ `ipow32 / 64` ([ v0.18.2 ](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.18.2))

### Ø¢Ø®Ø±

- ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¢Ù† Ø§Ø³ØªÙ†ØªØ§Ø¬ Ù†ÙˆØ¹ array literal Ù…Ù† Ù…Ø­ØªÙˆÙŠØ§ØªÙ‡Ø§([v0.9.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.0))
- ØªÙ… ØªØ­Ø¯ÙŠØ« stdlib Ø¥Ù„Ù‰ Unicode 13.0.0([v0.10.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.10.0))

## ÙƒÙŠÙ ØªÙ‚ÙˆÙ… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©ØŸ

1. ØªØºÙŠÙŠØ± `apiVersion` Mappings Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙÙŠ `subgraph.yaml` Ø¥Ù„Ù‰ `0.0.6`:

```yaml
...
dataSources:
  ...
    mapping:
      ...
      apiVersion: 0.0.6
      ...
```

2. Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« `graph-cli` Ø§Ù„Ø°ÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡ Ø¥Ù„Ù‰ `latest` Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ´ØºÙŠÙ„:

```bash
# if you have it globally installed
npm install --global @graphprotocol/graph-cli@latest

# or in your subgraph if you have it as a dev dependency
npm install --save-dev @graphprotocol/graph-cli@latest
```

3. Ø§ÙØ¹Ù„ Ø§Ù„Ø´ÙŠØ¡ Ù†ÙØ³Ù‡ Ù…Ø¹ `graph-ts` ØŒ ÙˆÙ„ÙƒÙ† Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù… ØŒ Ø§Ø­ÙØ¸Ù‡ ÙÙŠ dependencies Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:

```bash
npm install --save @graphprotocol/graph-ts@latest
```

4. Ø§ØªØ¨Ø¹ Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù„Ø§ØµÙ„Ø§Ø­ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù‡Ø§Ù…Ø© ÙÙŠ Ø§Ù„Ù„ØºØ©.
5. Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ `codegen` Ùˆ `deploy` Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.

## ØªØºÙŠÙŠØ±Ø§Øª Ù‡Ø§Ù…Ø©

### Nullability

ÙÙŠ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† AssemblyScript ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
function load(): Value | null { ... }

let maybeValue = load();
maybeValue.aMethod();
```

ÙˆÙ„ÙƒÙ† ÙÙŠ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£Ø­Ø¯Ø« ØŒ Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© nullable ØŒ ÙØ¥Ù†Ù‡Ø§ ØªØªØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø§Ù„ØªØ­Ù‚Ù‚ ØŒ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
let maybeValue = load()

if (maybeValue) {
  maybeValue.aMethod() // `maybeValue` is not null anymore
}
```

Ø£Ùˆ Ø¥Ø¬Ø¨Ø§Ø±Ù‡ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø­Ùˆ:

```typescript
let maybeValue = load()! // breaks in runtime if value is null

maybeValue.aMethod()
```

Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ØªØ£ÙƒØ¯Ø§ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø±Ùƒ ØŒ ÙÙ†Ø­Ù† Ù†ÙˆØµÙŠ Ø¯Ø§Ø¦Ù…Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¢Ù…Ù†. Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ØŒ ÙÙ‚Ø¯ ØªØ±ØºØ¨ ÙÙŠ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø¹Ø¨Ø§Ø±Ø© if Ø§Ù„Ù…Ø¨ÙƒØ±Ø© Ù…Ø¹ Ù‚ÙŠÙ…Ø© Ø±Ø§Ø¬Ø¹Ø© ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù€ subgraph Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.

### Variable Shadowing

Ù‚Ø¨Ù„ Ø£Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø¥Ø¬Ø±Ø§Ø¡ [variable shadowing](https://en.wikipedia.org/wiki/Variable_shadowing) ÙˆØªØ¹Ù…Ù„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¨Ø±Ù…Ø¬ÙŠØ© Ù…Ø«Ù„ Ù‡Ø°Ù‡:

```typescript
let a = 10
let b = 20
let a = a + b
```

Ù„ÙƒÙ† Ù‡Ø°Ø§ Ù„Ù… ÙŠØ¹Ø¯ Ù…Ù…ÙƒÙ†Ù‹Ø§ Ø§Ù„Ø¢Ù† ØŒ ÙˆÙŠØ±Ø¬Ø¹ Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø®Ø·Ø£:

```typescript
'ERROR TS2451: Cannot redeclare block-scoped variable 'a

; let a = a + b
 ~~~~~~~~~~~~~
in assembly/index.ts(4,3)
```

Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ variable shadowing.

### Ù…Ù‚Ø§Ø±Ø§Ù†Ø§Øª Null

Ù…Ù† Ø®Ù„Ø§Ù„ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ Subgraph Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ØŒ Ù‚Ø¯ ØªØ­ØµÙ„ Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ Ø¹Ù„Ù‰ Ø£Ø®Ø·Ø§Ø¡ Ù…Ø«Ù„ Ù‡Ø°Ù‡:

```typescript
ERROR TS2322: Type '~lib/@graphprotocol/graph-ts/common/numbers/BigInt | null' is not assignable to type '~lib/@graphprotocol/graph-ts/common/numbers/BigInt'.
     if (decimals == null) {
                     ~~~~
 in src/mappings/file.ts(41,21)
```

Ù„Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¨Ø³Ø§Ø·Ø© ØªØºÙŠÙŠØ± Ø¹Ø¨Ø§Ø±Ø© `if` Ø¥Ù„Ù‰ Ø´ÙŠØ¡ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
  if (!decimals) {

  // or

  if (decimals === null) {
```

Ø§Ù„Ø£Ù…Ø± Ù†ÙØ³Ù‡ ÙŠÙ†Ø·Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªÙØ¹Ù„ =! Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ==.

### Casting

ÙƒØ§Ù†Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ Casting Ù…Ù† Ù‚Ø¨Ù„ Ù‡ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙ„Ù…Ø© `as` ØŒ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
let byteArray = new ByteArray(10)
let uint8Array = byteArray as Uint8Array // equivalent to: <Uint8Array>byteArray
```

Ù„ÙƒÙ† Ù‡Ø°Ø§ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¥Ù„Ø§ ÙÙŠ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡ÙŠÙ†:

- Primitive casting (Ø¨ÙŠÙ† Ø§Ù†ÙˆØ§Ø¹ Ù…Ø«Ù„`u8`, `i32`, `bool`; eg: `let b: isize = 10; b as usize`);
- Upcasting Ø¹Ù„Ù‰ ÙˆØ±Ø§Ø«Ø© Ø§Ù„ÙØ¦Ø© (subclass â†’ superclass)

Ø£Ù…Ø«Ù„Ø©:

```typescript
// primitive casting
let a: usize = 10
let b: isize = 5
let c: usize = a + (b as usize)
```

```typescript
// upcasting on class inheritance
class Bytes extends Uint8Array {}

let bytes = new Bytes(2)
// <Uint8Array>bytes // same as: bytes as Uint8Array
```

There are two scenarios where you may want to cast, but using `as`/`<T>var` **isn't safe**:

- Downcasting ÙˆØ±Ø§Ø«Ø© Ø§Ù„ÙØ¦Ø© (superclass â†’ subclass)
- Ø¨ÙŠÙ† Ù†ÙˆØ¹ÙŠÙ† ÙŠØ´ØªØ±ÙƒØ§Ù† ÙÙŠ ÙØ¦Ø© superclass

```typescript
// downcasting on class inheritance
class Bytes extends Uint8Array {}

let uint8Array = new Uint8Array(2)
// <Bytes>uint8Array // breaks in runtime :(
```

```typescript
// between two types that share a superclass
class Bytes extends Uint8Array {}
class ByteArray extends Uint8Array {}

let bytes = new Bytes(2)
// <ByteArray>bytes // breaks in runtime :(
```

ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© `changetype<T>`:

```typescript
// downcasting on class inheritance
class Bytes extends Uint8Array {}

let uint8Array = new Uint8Array(2)
changetype<Bytes>(uint8Array) // works :)
```

```typescript
// between two types that share a superclass
class Bytes extends Uint8Array {}
class ByteArray extends Uint8Array {}

let bytes = new Bytes(2)
changetype<ByteArray>(bytes) // works :)
```

Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ ÙÙ‚Ø· Ø¥Ø²Ø§Ù„Ø© nullability ØŒ ÙÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… `as` (Ø£Ùˆ `<T>variable`) ØŒ ÙˆÙ„ÙƒÙ† ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ¹Ø±Ù Ø£Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø®Ø§Ù„ÙŠØ© ØŒ ÙˆØ¥Ù„Ø§ ÙØ¥Ù†Ù‡ Ø³ÙˆÙ ÙŠØªÙˆÙ‚Ù.

```typescript
// remove nullability
let previousBalance = AccountBalance.load(balanceId) // AccountBalance | null

if (previousBalance != null) {
  return previousBalance as AccountBalance // safe remove null
}

let newBalance = new AccountBalance(balanceId)
```

Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ø­Ø§Ù„Ø© Ø§Ù„ nullability ØŒ Ù†ÙˆØµÙŠ Ø¨Ø¥Ù„Ù‚Ø§Ø¡ Ù†Ø¸Ø±Ø© Ø¹Ù„Ù‰ [ Ù…Ù…ÙŠØ²Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† nullability ](https://www.assemblyscript.org/basics.html#nullability-checks) ØŒ Ø³ØªØ¬Ø¹Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ø§ğŸ™‚

Also we've added a few more static methods in some types to ease casting, they are:

- Bytes.fromByteArray
- Bytes.fromUint8Array
- BigInt.fromByteArray
- ByteArray.fromBigInt

### Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Nullability Ù…Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‰ Ø§Ù„Ø®Ø§ØµÙŠØ©

Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… [ Ù…Ù…ÙŠØ²Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† nullability ](https://www.assemblyscript.org/basics.html#nullability-checks) ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ø¨Ø§Ø±Ø§Øª `if` Ø£Ùˆ Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ (`ØŸ` Ùˆ`:`) Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
let something: string | null = 'data'

let somethingOrElse = something ? something : 'else'

// or

let somethingOrElse

if (something) {
  somethingOrElse = something
} else {
  somethingOrElse = 'else'
}
```

ÙˆÙ…Ø¹ Ø°Ù„Ùƒ ØŒ ÙØ¥Ù† Ù‡Ø°Ø§ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¥Ù„Ø§ Ø¹Ù†Ø¯ ØªÙ†ÙÙŠØ° `if` / ternary Ø¹Ù„Ù‰ Ù…ØªØºÙŠØ± ØŒ ÙˆÙ„ÙŠØ³ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø§ØµÙŠØ© ØŒ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
class Container {
  data: string | null
}

let container = new Container()
container.data = 'data'

let somethingOrElse: string = container.data ? container.data : 'else' // doesn't compile
```

Ø§Ù„Ø°ÙŠ ÙŠØ®Ø±Ø¬ Ù‡Ø°Ø§ Ø§Ù„Ø®Ø·Ø£:

```typescript
ERROR TS2322: Type '~lib/string/String | null' is not assignable to type '~lib/string/String'.

   let somethingOrElse: string = container.data ? container.data : "else";
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

Ù„Ø¥ØµÙ„Ø§Ø­ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØºÙŠØ± Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§ØµÙŠØ© Ø­ØªÙ‰ ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ±Ø¬Ù… Ù…Ù† Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ nullability:

```typescript
class Container {
  data: string | null
}

let container = new Container()
container.data = 'data'

let data = container.data

let somethingOrElse: string = data ? data : 'else' // compiles just fine :)
```

### Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„Ù„Ù…Ø´ØºÙ„ Ù…Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø§ØµÙŠØ©

(Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„) Ø¥Ø°Ø§ Ø­Ø§ÙˆÙ„Øª Ø¬Ù…Ø¹ Ù†ÙˆØ¹ nullable (Ù…Ù† ÙˆØµÙˆÙ„ Ø®Ø§ØµÙŠØ©) Ù…Ø¹ Ù†ÙˆØ¹ nullable ØŒ ÙØ¥Ù† Ù…ØªØ±Ø¬Ù… AssemblyScript Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø¹Ø·Ø§Ø¡ Ø®Ø·Ø£ ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙŠØ­Ø°Ø± Ù…Ù† Ø£Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù‚ÙŠÙ… nullableØŒ ÙˆØ¨Ù…Ø§ Ø£Ù†Ù‡ ÙŠÙ‚ÙˆÙ… ÙÙ‚Ø· Ø¨Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨ØµÙ…Øª ØŒ ÙØ¥Ù†Ù‡ ÙŠØªÙŠØ­ Ø§Ù„ÙØ±ØµØ© Ù„Ù„ÙƒÙˆØ¯ Ù„Ù„ØªÙˆÙ‚Ù ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„.

```typescript
class BigInt extends Uint8Array {
  @operator('+')
  plus(other: BigInt): BigInt {
    // ...
  }
}

class Wrapper {
  public constructor(public n: BigInt | null) {}
}

let x = BigInt.fromI32(2)
let y: BigInt | null = null

x + y // give compile time error about nullability

let wrapper = new Wrapper(y)

wrapper.n = wrapper.n + x // doesn't give compile time errors as it should
```

Ù„Ù‚Ø¯ ÙØªØ­Ù†Ø§ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ù…ØªØ±Ø¬Ù… AssemblyScript ØŒ ÙˆÙ„ÙƒÙ† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ Ø£Ø¬Ø±ÙŠØª Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙÙŠ Subgraph mappings ØŒ ÙÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ØªØºÙŠÙŠØ±Ù‡Ø§ Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ù„ null Ù‚Ø¨Ù„ Ø°Ù„Ùƒ.

```typescript
let wrapper = new Wrapper(y)

if (!wrapper.n) {
  wrapper.n = BigInt.fromI32(0)
}

wrapper.n = wrapper.n + x // now `n` is guaranteed to be a BigInt
```

### ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚ÙŠÙ…Ø©

Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ø£ÙŠ ÙƒÙˆØ¯ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
var value: Type // null
value.x = 10
value.y = 'content'
```

Ø³ÙŠØªÙ… ØªØ¬Ù…ÙŠØ¹Ù‡Ø§ Ù„ÙƒÙ†Ù‡Ø§ Ø³ØªØªÙˆÙ‚Ù ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ ØŒ ÙˆÙ‡Ø°Ø§ ÙŠØ­Ø¯Ø« Ù„Ø£Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ù… ØªØªÙ… ØªÙ‡ÙŠØ¦ØªÙ‡Ø§ ØŒ Ù„Ø°Ø§ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ subgraph Ù‚Ø¯ Ù‚Ø§Ù… Ø¨ØªÙ‡ÙŠØ¦Ø© Ù‚ÙŠÙ…Ù‡Ø§ ØŒ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø­Ùˆ Ø§Ù„ØªØ§Ù„ÙŠ:

```typescript
var value = new Type() // initialized
value.x = 10
value.y = 'content'
```

ÙˆØ£ÙŠØ¶Ù‹Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù„Ø¯ÙŠÙƒ Ø®ØµØ§Ø¦Øµ Ù„ nullable ÙÙŠ ÙƒÙŠØ§Ù† GraphQL ØŒ Ù…Ø«Ù„ Ù‡Ø°Ø§:

```graphql
type Total @entity {
  id: Bytes!
  amount: BigInt
}
```

ÙˆÙ„Ø¯ÙŠÙƒ ÙƒÙˆØ¯ Ù…Ø´Ø§Ø¨Ù‡ Ù„Ù‡Ø°Ø§:

```typescript
let total = Total.load('latest')

if (total === null) {
  total = new Total('latest')
}

total.amount = total.amount + BigInt.fromI32(1)
```

ÙØ³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ‡ÙŠØ¦Ø© Ù‚ÙŠÙ…Ø© `total.amount` ØŒ Ù„Ø£Ù†Ù‡ Ø¥Ø°Ø§ Ø­Ø§ÙˆÙ„Øª Ø§Ù„ÙˆØµÙˆÙ„ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£Ø®ÙŠØ± Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹ ØŒ ÙØ³ÙˆÙ ÙŠØªØ¹Ø·Ù„. Ù„Ø°Ù„Ùƒ Ø¥Ù…Ø§ Ø£Ù† ØªÙ‚ÙˆÙ… Ø¨ØªÙ‡ÙŠØ¦ØªÙ‡ Ø£ÙˆÙ„Ø§Ù‹:

```typescript
let total = Total.load('latest')

if (total === null) {
  total = new Total('latest')
  total.amount = BigInt.fromI32(0)
}

total.tokens = total.tokens + BigInt.fromI32(1)
```

Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ ÙÙ‚Ø· ØªØºÙŠÙŠØ± Ù…Ø®Ø·Ø· GraphQL Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨Ø­ÙŠØ« Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… Ù†ÙˆØ¹ nullable Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø§ØµÙŠØ© ØŒ Ø«Ù… Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªÙ‡ÙŠØ¦ØªÙ‡ Ø¹Ù„Ù‰ Ø£Ù†Ù‡ ØµÙØ± ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ©`codegen`ğŸ˜‰

```graphql
type Total @entity {
  id: Bytes!
  amount: BigInt!
}
```

```typescript
let total = Total.load('latest')

if (total === null) {
  total = new Total('latest') // already initializes non-nullable properties
}

total.amount = total.amount + BigInt.fromI32(1)
```

### ØªÙ‡ÙŠØ¦Ø© Ø®Ø§ØµÙŠØ© Ø§Ù„ÙØ¦Ø©

Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªØµØ¯ÙŠØ± (export) Ø£ÙŠ ÙØ¦Ø§Øª Ø°Ø§Øª Ø®ØµØ§Ø¦Øµ ÙØ¦Ø§Øª Ø£Ø®Ø±Ù‰ (ØªÙ… ØªØ¹Ø±ÙŠÙÙ‡Ø§ Ø¨ÙˆØ§Ø³Ø·ØªÙƒ Ø£Ùˆ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©) Ù…Ø«Ù„ Ù‡Ø°Ø§:

```typescript
class Thing {}

export class Something {
  value: Thing
}
```

ÙØ¥Ù† Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø³ÙŠØ®Ø·Ø¦ Ù„Ø£Ù†Ùƒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù…Ø§ Ù„Ø¥Ø¶Ø§ÙØ© Ù…ÙÙ‡ÙŠØ¦ Ù„Ù„Ø®ØµØ§Ø¦Øµ ÙˆØ§Ù„ØªÙŠ Ù‡ÙŠ ÙØ¦Ø§Øª (classes)ØŒ Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ `!`:

```typescript
export class Something {
  constructor(public value: Thing) {}
}

// or

export class Something {
  value: Thing

  constructor(value: Thing) {
    this.value = value
  }
}

// or

export class Something {
  value!: Thing
}
```

### Array initialization

The `Array` class still accepts a number to initialize the length of the list, however you should take care because operations like `.push` will actually increase the size instead of adding to the beginning, for example:

```typescript
let arr = new Array<string>(5) // ["", "", "", "", ""]

arr.push('something') // ["", "", "", "", "", "something"] // size 6 :(
```

Depending on the types you're using, eg nullable ones, and how you're accessing them, you might encounter a runtime error like this one:

```
ERRO Handler skipped due to execution failure, error: Mapping aborted at ~lib/array.ts, line 110, column 40, with message: Element type must be nullable if array is holey  wasm backtrace:     0: 0x19c4 - <unknown>!~lib/@graphprotocol/graph-ts/index/format         1: 0x1e75 - <unknown>!~lib/@graphprotocol/graph-ts/common/collections/Entity#constructor        2: 0x30b9 - <unknown>!node_modules/@graphprotocol/graph-ts/global/global/id_of_type
```

To actually push at the beginning you should either, initialize the `Array` with size zero, like this:

```typescript
let arr = new Array<string>(0) // []

arr.push('something') // ["something"]
```

Or you should mutate it via index:

```typescript
let arr = new Array<string>(5) // ["", "", "", "", ""]

arr[0] = 'something' // ["something", "", "", "", ""]
```

### GraphQL schema

This is not a direct AssemblyScript change, but you may have to update your `schema.graphql` file.

Now you no longer can define fields in your types that are Non-Nullable Lists. If you have a schema like this:

```graphql
type Something @entity {
  id: Bytes!
}

type MyEntity @entity {
  id: Bytes!
  invalidField: [Something]! # no longer valid
}
```

You'll have to add an `!` to the member of the List type, like this:

```graphql
type Something @entity {
  id: Bytes!
}

type MyEntity @entity {
  id: Bytes!
  invalidField: [Something!]! # valid
}
```

This changed because of nullability differences between AssemblyScript versions, and it's related to the `src/generated/schema.ts` file (default path, you might have changed this).

### Ø¢Ø®Ø±

- ØªÙ… Ø¶Ø¨Ø· `Map#set` Ùˆ`Set#add` Ù…Ø¹ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª ØŒ Ø±Ø§Ø¬Ø¹Ø§ Ø¨Ù€ `this` ([v0.9.2](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.9.2))
- Ù„Ù… ØªØ¹Ø¯ Ø§Ù„Ù…ØµÙÙˆÙØ© ØªØ±Ø« Ù…Ù† ArrayBufferView ØŒ Ù„ÙƒÙ†Ù‡Ø§ Ø£ØµØ¨Ø­Øª Ù…ØªÙ…ÙŠØ²Ø© Ø§Ù„Ø¢Ù† ([ v0.10.0 ](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.10.0))
- Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ù‡ÙŠØ¦Ø© Ù…Ù† ÙƒØ§Ø¦Ù† Ù„Ù… ÙŠØ¹Ø¯ Ø¨Ø¥Ù…ÙƒØ§Ù†Ù‡Ø§ ØªØ¹Ø±ÙŠÙ Ø¨Ø§Ù†ÙŠ (constructor) Ù„Ù‡Ø§ ([v0.10.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.10.0))
- Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ© `**` Ù‡ÙŠ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ù…Ù‚Ø§Ù… Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙƒÙ„Ø§ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ÙŠÙ† Ø¹Ø¯Ø¯Ø§ ØµØ­ÙŠØ­Ø§. ÙÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙƒØ§Ù†Øª Ø§Ù„Ù†ØªÙŠØ¬Ø© float ÙƒÙ…Ø§ Ù„Ùˆ ÙƒØ§Ù† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ `Math/f.pow` ([v0.11.0](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.11.0))
- Ø¥Ø¬Ø¨Ø§Ø±`NaN` Ø¥Ù„Ù‰ `false` Ø¹Ù†Ø¯Ù…Ø§ Ø§Ù„ casting Ø¥Ù„Ù‰`bool` ([v0.14.9](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.14.9))
- Ø¹Ù†Ø¯ Ø¥Ø²Ø§Ø­Ø© Ù‚ÙŠÙ…Ø© Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ ØµØºÙŠØ± Ù…Ù† Ø§Ù„Ù†ÙˆØ¹ `i8`/`u8` Ø£Ùˆ `i16`/`u16` ØŒ ÙØ¥Ù† ÙÙ‚Ø· Ø§Ù„Ù€ 3 Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ Ù„Ù€ 4 Ø¨ØªØ§Øª Ø§Ù„Ø£Ù‚Ù„ Ø£Ù‡Ù…ÙŠØ© Ù…Ù† Ù‚ÙŠÙ…Ø© RHS ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØŒ Ø¹Ù„Ù‰ ØºØ±Ø§Ø± Ù†ØªÙŠØ¬Ø© `i32.shl` Ø§Ù„Ù…ØªØ£Ø«Ø±Ø© ÙÙ‚Ø· Ø¨Ø§Ù„Ù€ 5 Ø¨ØªØ§Øª Ø§Ù„Ø£Ù‚Ù„ Ø£Ù‡Ù…ÙŠØ© Ù…Ù† Ù‚ÙŠÙ…Ø© RHS.. Ù…Ø«Ø§Ù„: `someI8 << 8` Ø£Ù†ØªØ¬ Ø³Ø§Ø¨Ù‚Ù‹Ø§ Ø§Ù„Ù‚ÙŠÙ…Ø© `0` ØŒ ÙˆÙ„ÙƒÙ†Ù‡ ÙŠÙ†ØªØ¬ Ø§Ù„Ø¢Ù† `SomeI8` Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø¥Ø®ÙØ§Ø¡ RHS ÙƒÙ€ `8 & 7 = 0`(3 Ø¨Øª) ([ v0.17.0 ](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.17.0))
- Ø¥ØµÙ„Ø§Ø­ Ø®Ù„Ù„ Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø¹Ù„Ø§Ø¦Ù‚ÙŠØ© (relational string) Ø¹Ù†Ø¯Ù…Ø§ ØªØ®ØªÙ„Ù Ø§Ù„Ø£Ø­Ø¬Ø§Ù… ([v0.17.8](https://github.com/AssemblyScript/assemblyscript/releases/tag/v0.17.8))
