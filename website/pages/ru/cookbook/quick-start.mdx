---
title: Быстрый старт
---

В этом руководстве вы быстро узнаете, как инициализировать, создать и развернуть свой сабграф на:

- **Subgraph Studio** - используется только для сабграфов, которые индексируют **Основную сеть Ethereum**
- **Размещенный сервис** - используется для сабграфов, которые индексируют **другие сети** за пределами основной сети Ethereum (например, Binance, Matic и т.д.)

## Subgraph Studio

### 1. Установка the Graph CLI

Графический интерфейс Graph CLI написан на JavaScript, и для его использования вам потребуется установить либо `npm`, либо `yarn`.

```sh
# NPM
$ npm install -g @graphprotocol/graph-cli

# Yarn
$ yarn global add @graphprotocol/graph-cli
```

### 2. Инициализация вашего сабграфа

- Инициализируйте свой сабграф из существующего контракта.

```sh
graph init --studio <SUBGRAPH_SLUG>
```

- Ваш сабграф slug - это идентификатор для вашего сабграфа. Инструмент CLI проведет вас через шаги по созданию сабграфа, такого как адрес контракта, сеть и т. д., как вы можете видеть на скриншоте ниже.

![Команда сабграфа](/img/Subgraph-Slug.png)

> Примечание: Рассмотрите возможность добавления `--index-events` к приведенной выше команде, чтобы сэкономить время. Он загружает сабграф с объектами в схеме и простыми сопоставлениями для каждого отправляемого события.

### 3. Создание вашего Сабграфа

Предыдущая команда создала "скелет" сабграфа, который вы можете использовать в качестве отправной точки для построения вашего сабграфа. При внесении изменений в сабграф вы будете в основном работать с тремя файлами:

- Манифест (subgraph.yaml) - Манифест определяет, какие источники данных будут индексироваться вашими сабграфами.
- Схема (schema.graphql) - Схема GraphQL определяет, какие данные вы хотите извлечь из сабграфа.
- Сопоставления сценариев сборки (mapping.ts) - это код, который преобразует данные из ваших источников данных в объекты, определенные в схеме.

Для получения дополнительной информации о том, как написать свой подграф, см. [Создание сабграфа](/developing/creating-a-subgraph).

### 4. Развертывание в Subgraph Studio

- Перейдите в Subgraph Studio [https://thegraph.com/studio /](https://thegraph.com/studio/) и подключите свой кошелек.
- Нажмите "Создать" и введите фрагмент сабграфа, который вы использовали на шаге 2.
- Запустите эти команды в папке subgraph

```sh
$ graph codegen
$ graph build
```

- Аутентифицируйте и разверните свой сабграф. Ключ развертывания можно найти на странице Subgraph в Subgraph Studio.

```sh
$ graph auth --studio <DEPLOY_KEY>
$ graph deploy --studio <SUBGRAPH_SLUG>
```

- Вас попросят указать метку версии. Настоятельно рекомендуется использовать следующие соглашения для присвоения имен вашим версиям. Пример: `0.0.1`, `v1`, `версия1`

### 5. Проверка ваших журналов

Журналы должны сообщить вам, есть ли какие-либо ошибки. Если ваш сабграф не работает, вы можете запросить работоспособность сабграфа, используя [Игровая площадка GraphiQL](https://graphiql-online.com/). Используйте [эта конечная точка](https://api.thegraph.com/index-node/graphql). Обратите внимание, что вы можете воспользоваться приведенным ниже запросом и ввести свой идентификатор развертывания для вашего сабграфа. В этом случае `Qm...` - это идентификатор развертывания (который можно найти на странице сабграфа в разделе **Подробности**). Приведенный ниже запрос сообщит вам, когда происходит сбой сабграфа, чтобы вы могли соответствующим образом выполнить отладку:

```sh
{
  indexingStatuses(subgraphs: ["Qm..."]) {
    node
    synced
    health
    fatalError {
      message
      block {
        number
        hash
      }
      handler
    }
    nonFatalErrors {
      message
      block {
        number
        hash
      }
      handler
    }
    chains {
      network
      chainHeadBlock {
        number
      }
      earliestBlock {
        number
      }
      latestBlock {
        number
      }
      lastHealthyBlock {
        number
      }
    }
    entityCount
  }
}
```

### 6. Запрос вашего Сабграфа

Теперь вы можете запросить свой сабграф, следуя [этим инструкциям](/querying/querying-the-graph). Вы можете запросить из своего DApp, если у вас нет ключа API, с помощью бесплатного временного URL-адреса запроса с ограниченной скоростью, который можно использовать для разработки и промежуточного размещения. Вы можете прочитать дополнительные инструкции о том, как запросить сабграф из интерфейсного приложения [здесь](/querying/querying-from-an-application).

## Хостинговый сервис

### 1. Установка the Graph CLI

"Graph CLI - это npm-пакет, и для его использования вам потребуется установить `npm` или `yarn`.

```sh
# NPM
$ npm install -g @graphprotocol/graph-cli

# Yarn
$ yarn global add @graphprotocol/graph-cli
```

### 2. Инициализация вашего сабграфа

- Инициализируйте свой сабграф из существующего контракта.

```sh
$ graph init --product hosted-service --from-contract <Address>
```

- Вас попросят ввести название сабграфа. Формат `<Github>/<Название сабграфа>`. Пример: `graphprotocol/examplesubgraph`

- Если вы хотите выполнить инициализацию по примеру, выполните приведенную ниже команду:

```sh
$ graph init --product hosted-service --from-example
```

- В случае примера сабграф основан на контракте Gravity от Dani Grant, который управляет пользовательскими аватарами и выдает события `NewGravatar` или `UpdateGravatar` всякий раз, когда создаются или обновляются аватары.

### 3. Создание вашего Сабграфа

Предыдущая команда создаст каркас, из которого вы сможете построить свой сабграф. При внесении изменений в сабграф вы будете в основном работать с тремя файлами:

- Манифест (subgraph.yaml) - Манифест определяет, какие источники данных будут индексироваться вашими сабграфами
- Схема (schema.graphql) - Схема GraphQL определяет, какие данные вы хотите извлечь из сабграфа
- Сопоставления сценариев сборки (mapping.ts) - это код, который преобразует данные из ваших источников данных в объекты, определенные в схеме

Для получения дополнительной информации о том, как написать свой подграф, см. [Создание сабграфа](/developing/creating-a-subgraph).

### 4. Развертывание вашего Сабграфа

- Войдите в [Размещенный сервис](https://thegraph.com/hosted-service/) с использованием вашей учетной записи GitHub
- Нажмите Добавить сабграф и заполните необходимую информацию. Используйте то же имя сабграфа, что и на шаге 2.
- Запустите `codegen` в папке subgraph

```sh
 # NPM
$ npm run codegen

# Yarn
$ yarn codegen
```

- Добавьте свой токен доступа и разверните свой сабграф. Маркер доступа находится на вашей панели мониторинга в размещенной службе.

```sh
$ graph auth --product hosted-service <ACCESS_TOKEN>
$ graph deploy --product hosted-service <GITHUB_USER>/<SUBGRAPH NAME>
```

### 5. Проверка ваших журналов

Журналы должны сообщить вам, есть ли какие-либо ошибки. Если ваш сабграф не работает, вы можете запросить работоспособность сабграфа, используя [Игровая площадка GraphiQL](https://graphiql-online.com/). Используйте [эта конечная точка](https://api.thegraph.com/index-node/graphql). Обратите внимание, что вы можете воспользоваться приведенным ниже запросом и ввести свой идентификатор развертывания для вашего сабграфа. В этом случае `Qm...` - это идентификатор развертывания (который можно найти на странице сабграфа в разделе **Подробности**). Приведенный ниже запрос сообщит вам, когда происходит сбой сабграфа, чтобы вы могли соответствующим образом выполнить отладку:

```sh
{
  indexingStatuses(subgraphs: ["Qm..."]) {
    node
    synced
    health
    fatalError {
      message
      block {
        number
        hash
      }
      handler
    }
    nonFatalErrors {
      message
      block {
        number
        hash
      }
      handler
    }
    chains {
      network
      chainHeadBlock {
        number
      }
      earliestBlock {
        number
      }
      latestBlock {
        number
      }
      lastHealthyBlock {
        number
      }
    }
    entityCount
  }
}
```

### 6. Запрос вашего Сабграфа

Следуйте [tэтим инструкциям](/querying/querying-the-hosted-service), чтобы запросить ваш сабграф в размещенном сервисе.
