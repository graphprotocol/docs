---
title: ایک کنٹریکٹ کو تبدیل کریں اور اس کی تاریخ کو گرافٹنگ کے ساتھ رکھیں
---

اس گائیڈ میں، آپ سیکھیں گے کہ موجودہ سب گراف کو گرافٹنگ کرکے نئے سب گراف کیسے بنائے اور ان کو تعینات کریں.

## گرافٹنگ کیا ہے؟

گرافٹنگ موجودہ سب گراف سے ڈیٹا کو دوبارہ استعمال کرتا ہے اور اسے بعد کے بلاک میں انڈیکس کرنا شروع کرتا ہے۔ میپنگ میں ماضی کی سادہ غلطیوں کو تیزی سے حاصل کرنے یا کسی موجودہ سب گراف کے ناکام ہونے کے بعد اسے عارضی طور پر دوبارہ کام کرنے کے لیے یہ ترقی کے دوران مفید ہے۔ نیز، اس کا استعمال کسی سب گراف میں فیچر شامل کرتے وقت کیا جا سکتا ہے جو شروع سے انڈیکس میں زیادہ وقت لیتا ہے.

گرافٹڈ سب گراف ایک گراف کیو ایل اسکیما استعمال کرسکتا ہے جو بیس سب گراف میں سے ایک سے مماثل نہیں ہے، لیکن اس کے ساتھ محض مطابقت رکھتا ہے۔ اسے اپنے طور پر ایک درست سب گراف سکیما ہونا چاہیے، لیکن درج ذیل طریقوں سے بنیادی سب گراف کے سکیما سے انحراف ہو سکتا ہے:

- یہ ہستی کی اقسام کو جوڑتا یا ہٹاتا ہے
- یہ ہستی کی اقسام سے صفات کو ہٹاتا ہے
- یہ ہستی کی قسموں میں کالعدم صفات کو شامل کرتا ہے
- یہ غیر کالعدم صفات کو کالعدم صفات میں بدل دیتا ہے
- یہ enums میں اقدار کا اضافہ کرتا ہے
- یہ انٹرفیس کو جوڑتا یا ہٹاتا ہے
- یہ تبدیل ہوتا ہے جس کے لیے ایک انٹرفیس لاگو کیا جاتا ہے

مزید معلومات کے لۓ، آپ دیکہ سکتے ہیں:

- [گرافٹنگ](/developing/creating-a-subgraph#grafting-onto-existing-subgraphs)

اس ٹیوٹوریل میں، ہم استعمال کے ایک بنیادی کیس کا احاطہ کریں گے۔ ہم موجودہ معاہدے کو ایک جیسے کنٹریکٹ سے بدل دیں گے (ایک نئے پتہ کے ساتھ، لیکن ایک ہی کوڈ کے ساتھ)۔ اس کے بعد، موجودہ سب گراف کو "بیس" سب گراف پر گرافٹ کریں جو نئے کنٹریکٹ کو ٹریک کرتا ہے.

## نیٹ ورک میں اپ گریڈ کرتے وقت گرافٹنگ پر اہم نوٹ

> **Caution**: It is recommended to not use grafting for subgraphs published to The Graph Network

### یہ کیوں اہم ہے؟

گرافٹنگ ایک طاقتور خصوصیت ہے جو آپ کو ایک سب گراف کو دوسرے پر "گرافٹ" کرنے کی اجازت دیتی ہے، مؤثر طریقے سے تاریخی ڈیٹا کو موجودہ سب گراف سے نئے ورژن میں منتقل کرتی ہے۔ اگرچہ یہ ڈیٹا کو محفوظ رکھنے اور انڈیکسنگ پر وقت بچانے کا ایک مؤثر طریقہ ہے، لیکن گرافٹنگ کسی میزبان ماحول سے ڈیسنٹرالا ئزڈ نیٹ ورک کی طرف ہجرت کرتے وقت پیچیدگیوں اور ممکنہ مسائل کو پیش کر سکتی ہے۔ گراف نیٹ ورک سے سب گراف کو ہوسٹڈ سروس یا سب گراف اسٹوڈیو میں واپس کرنا ممکن نہیں ہے.

### بہترین طریقے

**ابتدائی منتقلی**: جب آپ پہلی بار اپنے سب گراف کو ڈیسنٹرالا ئزڈ نیٹ ورک پر تعینات کرتے ہیں، تو بغیر گرافٹنگ کے ایسا کریں۔ یقینی بنائیں کہ سب گراف مستحکم ہے اور توقع کے مطابق کام کر رہا ہے.

**بعد کے اپ ڈیٹس**: ایک بار جب آپ کا سب گراف ڈیسینٹرلائزڈ نیٹ ورک پر لائیو اور مستحکم ہو جاتا ہے، تو آپ منتقلی کو ہموار بنانے اور تاریخی ڈیٹا کو محفوظ رکھنے کے لیے مستقبل کے ورژنز کے لیے گرافٹنگ کا استعمال کر سکتے ہیں.

ان رہنما خطوط پر عمل پیرا ہو کر، آپ خطرات کو کم کرتے ہیں اور منتقلی کے ایک ہموار عمل کو یقینی بناتے ہیں.

## ایک موجودہ سب گراف بنانا

Building subgraphs is an essential part of The Graph, described more in depth [here](/quick-start/). To be able to build and deploy the existing subgraph used in this tutorial, the following repo is provided:

- [سب گراف مثلی ریپو](https://github.com/t-proctor/grafting-tutorial)

> نوٹ: سب گراف میں استعمال ہونے والا کنٹریکٹ درج ذیل [ہیکاتھون سٹارٹر کٹ](https://github.com/schmidsi/hackathon-starterkit) سے لیا گیا تھا.

## سب گراف مینی فیسٹ کی تعریف

سب گراف مینی فیسٹ `subgraph.yaml` سب گراف کے لیے ڈیٹا کے ذرائع، دلچسپی کے محرکات، اور ان افعال کی نشاندہی کرتا ہے جو ان محرکات کے جواب میں چلائے جانے چاہئیں۔ ذیل میں ایک سب گراف مینی فیسٹ کی مثال دیکھیں جو آپ استعمال کریں گے:

```yaml
specVersion: 0.0.4
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: Lock
    network: goerli
    source:
      address: '0x4Ed995e775D3629b0566D2279f058729Ae6EA493'
      abi: Lock
      startBlock: 7674603
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Withdrawal
      abis:
        - name: Lock
          file: ./abis/Lock.json
      eventHandlers:
        - event: Withdrawal(uint256,uint256)
          handler: handleWithdrawal
      file: ./src/lock.ts
```

- `Lock` ڈیٹا کا ذریعہ abi اور کنٹریکٹ ایڈریس ہے جب ہم کنٹریکٹ کو مرتب اور تعینات کریں گے
- نیٹ ورک کو انڈیکسڈ نیٹ ورک کے مطابق ہونا چاہئے جس سے کیوری کیا جا رہا ہے۔ چونکہ ہم گوئرلی ٹیسٹ نیٹ پر چل رہے ہیں، نیٹ ورک `goerli` ہے
- `mapping` سیکشن دلچسپی کے محرکات اور ان افعال کی وضاحت کرتا ہے جنہیں ان محرکات کے جواب میں چلایا جانا چاہیے۔ اس صورت میں، ہم `Withdrawal` ایونٹ کو سن رہے ہیں اور جب یہ خارج ہوتا ہے تو `handleWithdrawal` فنکشن کو کال کر رہے ہیں.

## گرافٹنگ مینی فیسٹ کی تعریف

گرافٹنگ کے لیے اصل سب گراف مینی فیسٹ میں دو نئے آئٹمز شامل کرنے کی ضرورت ہے:

```yaml
---
features:
  - grafting # feature name
graft:
  base: Qm... # subgraph ID of base subgraph
  block: 1502122 # block number
```

- `features:` is a list of all used [feature names](/developing/creating-a-subgraph/#experimental-features).
- `graft:` `base` سب گراف کا نقشہ ہے اور اس پر گرافٹ کرنے کے لیے بلاک ہے۔ `block` وہ بلاک نمبر ہے جس سے انڈیکس کرنا شروع کیا جائے۔ گراف بیس سب گراف کے ڈیٹا کو دیے گئے بلاک تک اور اس سمیت کاپی کرے گا اور پھر اس بلاک سے نئے سب گراف کو انڈیکس کرنا جاری رکھے گا.

`base` اور `block` اقدار کو دو سب گراف لگا کر تلاش کیا جا سکتا ہے: ایک بیس انڈیکسنگ کے لیے اور ایک گرافٹنگ کے ساتھ ہے

## بیس سب گراف تعینات کرنا

1. Go to [Subgraph Studio](https://thegraph.com/studio/) and create a subgraph on Goerli testnet called `graft-example`
2. `AUTH & DEPLOY` سیکشن میں `graft-example` فولڈر میں اپنے سب گراف صفحہ پر دی گئی ہدایات پر عمل کریں ریپو سے
3. ایک دفعہ ختم ہو جاۓ، تصدیق کریں کے سب گراف صحیح سے انڈیکس ہو رہا ہے. اگر آپ درج کمانڈ گراف پلے گراونڈ میں چلائیں

```graphql
{
  withdrawals(first: 5) {
    id
    amount
    when
  }
}
```

یہ کچھ اس طرح لوٹاتا ہے:

```
{
  "data": {
    "withdrawals": [
      {
        "id": "0x13098b538a61837e9f29b32fb40527bbbe63c9120c250242b02b69bb42c287e5-5",
        "amount": "0",
        "when": "1664367528"
      },
      {
        "id": "0x800c92fcc0edbd26f74e19ad058c62008a47c7789f2064023b987028343dd498-3",
        "amount": "0",
        "when": "1664367648"
      }
    ]
  }
}
```

ایک بار آپ نے تصدیق کر لی کے سب گراف صحیح سے انڈیکس ہو رہا، آپ جلدی سے گرافٹنگ سے اسے اپڈیٹ کر سکتے ہیں.

## گرافٹنگ سب گراف کو تعینات کرنا

گرافٹ متبادل subgraph.yaml کے پاس ایک نیا کنٹریکٹ ایڈریس ہوگا۔ یہ اس وقت ہو سکتا ہے جب آپ اپنے ڈیپ کو اپ ڈیٹ کرتے ہیں، کسی کنٹریکٹ کو دوبارہ استعمال کرتے ہیں، وغیر.

1. Go to [Subgraph Studio](https://thegraph.com/studio/) and create a subgraph on Goerli testnet called `graft-replacement`
2. Create a new manifest. The `subgraph.yaml` for `graph-replacement` contains a different contract address and new information about how it should graft. These are the `block` of the [last event emitted](https://goerli.etherscan.io/tx/0x800c92fcc0edbd26f74e19ad058c62008a47c7789f2064023b987028343dd498) you care about by the old contract and the `base` of the old subgraph. The `base` subgraph ID is the `Deployment ID` of your original `graph-example` subgraph. You can find this in Subgraph Studio.
3. `AUTH & DEPLOY` سیکشن میں `graft-example` فولڈر میں اپنے سب گراف صفحہ پر دی گئی ہدایات پر عمل کریں ریپو سے
4. ایک دفعہ ختم ہو جاۓ، تصدیق کریں کے سب گراف صحیح سے انڈیکس ہو رہا ہے. اگر آپ درج کمانڈ گراف پلے گراونڈ میں چلائیں

```graphql
{
  withdrawals(first: 5) {
    id
    amount
    when
  }
}
```

اسے مندرجہ ذیل کو واپس کرنا چاہئے:

```
{
  "data": {
    "withdrawals": [
      {
        "id": "0x13098b538a61837e9f29b32fb40527bbbe63c9120c250242b02b69bb42c287e5-5",
        "amount": "0",
        "when": "1664367528"
      },
      {
        "id": "0x800c92fcc0edbd26f74e19ad058c62008a47c7789f2064023b987028343dd498-3",
        "amount": "0",
        "when": "1664367648"
      },
      {
        "id": "0xb4010e4c76f86762beb997a13cf020231778eaf7c64fa3b7794971a5e6b343d3-22",
        "amount": "0",
        "when": "1664371512"
      }
    ]
  }
}
```

آپ دیکھ سکتے ہیں کہ `graft-replacement` سب گراف پرانے `graph-example` ڈیٹا اور نئے کنٹریکٹ کے پتے سے نئے ڈیٹا سے ترتیب دے رہا ہے۔ اصل کنٹریکٹ سے دو `Withdrawl` ایونٹس کا اخراج ہوا، [ایونٹ 1](https://goerli.etherscan.io/tx/0x800c92fcc0edbd26f74e19ad058c62008a47c7789f2064023b987028343dd498) اور [ایونٹ 2](https://goerli.etherscan.io/address/0x4ed995e775d3629b0566d2279f058729ae6ea493). نیا کنٹریکٹ ایک `Withdrawl` کے بعد، [ایونٹ 3](https://goerli.etherscan.io/tx/0xb4010e4c76f86762beb997a13cf020231778eaf7c64fa3b7794971a5e6b343d3). پہلے سے ترتیب دی گئی دو ٹرانزیکشنز (ایونٹ 1 اور 2) اور نئی ٹرانزیکشن (ایونٹ 3) کو ایک ساتھ `graft-replacement` سب گراف میں ملایا گیا تھا.

Congrats! You have successfully grafted a subgraph onto another subgraph.

## اضافی وسائل

اگر آپ گرافٹنگ کے ساتھ مزید تجربہ چاہتے ہیں، تو یہاں مقبول کنٹریکٹس کے لیے چند مثالیں ہیں:

- [Curve](https://github.com/messari/subgraphs/blob/master/subgraphs/curve-finance/protocols/curve-finance/config/templates/curve.template.yaml)
- [ERC-721](https://github.com/messari/subgraphs/blob/master/subgraphs/erc721-metadata/subgraph.yaml)
- [Uniswap](https://github.com/messari/subgraphs/blob/master/subgraphs/uniswap-v3-forks/protocols/uniswap-v3/config/templates/uniswapV3Template.yaml),

To become even more of a Graph expert, consider learning about other ways to handle changes in underlying datasources. Alternatives like [Data Source Templates](/developing/creating-a-subgraph/#data-source-templates) can achieve similar results

> نوٹ: اس مضمون کا بہت سا مواد پہلے شائع شدہ [آرویو آرٹیکل](/cookbook/arweave/) سے لیا گیا ہے
