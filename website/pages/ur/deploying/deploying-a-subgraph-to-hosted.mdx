---
title: سب گراف کو ہوسٹڈ سروس پر تعینات کرنا
---

> اگر کوئی نیٹ ورک ہوسٹڈ سروس پر تعاون یافتہ نہیں ہے، تو آپ اسے انڈیکس کرنے کے لیے اپنا اپنا [گراف-نوڈ](https://github.com/graphprotocol/graph-node) چلا سکتے ہیں.

یہ صفحہ بتاتا ہے کہ ہوسٹڈ سروس میں سب گراف کو کیسے تعینات کیا جائے۔ سب گراف کو تعینات کرنے کے لیے آپ کو پہلے [Graph CLI](https://github.com/graphprotocol/graph-cli) کو انسٹال کرنا ہوگا۔ اگر آپ نے پہلے سے سب گراف نہیں بنایا ہے تو دیکھیں [سب گراف بنانا](/developing/creating-a-subgraph).

## ہوسٹڈ سروس اکاؤنٹ بنائیں

ہوسٹڈ سروس استعمال کرنے سے پہلے، ہماری ہوسٹڈ سروس میں ایک اکاؤنٹ بنائیں۔ اس کے لیے آپ کو ایک [گٹ ہب](https://github.com/) اکاؤنٹ کی ضرورت ہوگی۔ اگر آپ کے پاس نہیں ہے تو آپ کو پہلے اسے بنانے کی ضرورت ہے۔ پھر، [ہوسٹڈ سروس](https://thegraph.com/hosted-service/) پر جائیں، _'گٹ ہب کے ساتھ سائن اپ کریں' پر کلک کریں۔ _بٹن، اور گٹ ہب کی اجازت کے بہاؤ کو مکمل کریں.

## ایکسیس ٹوکن سٹور کریں

اکاؤنٹ بنانے کے بعد، اپنے [ڈیش بورڈ](https://thegraph.com/hosted-service/dashboard) پر جائیں۔ ڈیش بورڈ پر دکھائے گئے رسائی ٹوکن کو کاپی کریں اور `graph auth --product hosted-service <ACCESS_TOKEN>` چلائیں۔ یہ ایکسیس ٹوکن کو آپ کے کمپیوٹر پر محفوظ کر دے گا۔ آپ کو یہ صرف ایک بار کرنے کی ضرورت ہے، یا اگر آپ کبھی ایکسیس ٹوکن کو دوبارہ تخلیق کرتے ہیں.

## ہوسٹڈ سروس پر سب گراف بنائیں

سب گراف کو تعینات کرنے سے پہلے، آپ کو اسے گراف ایکسپلورر میں بنانا ہوگا۔ [ڈیش بورڈ](https://thegraph.com/hosted-service/dashboard) پر جائیں اور _'سب گراف شامل کریں'_ پر کلک کریں۔ بٹن دبائیں اور نیچے دی گئی معلومات کو مناسب طریقے سے بھریں:

**تصویر** - سب گراف کے لیے پیش نظارہ تصویر اور تھمب نیل کے طور پر استعمال کرنے کے لیے ایک تصویر منتخب کریں.

**سب گراف کا  نام** - اکاؤنٹ کے نام کے ساتھ جس کے تحت سب گراف بنایا گیا ہے، یہ `account-name/subgraph-name`-سٹائل نام کی بھی وضاحت کرے گا جو تعیناتیوں اور گراف کیو ایل اینڈ پوائنٹس کے لیے استعمال ہوتا ہے۔ _اس فیلڈ کو بعد میں تبدیل نہیں کیا جاسکتا۔_

**اکاونٹ** - وہ اکاؤنٹ جس کے تحت سب گراف بنایا گیا ہے۔ یہ کسی فرد یا تنظیم کا اکاؤنٹ ہو سکتا ہے۔ _سب گرافس کو بعد میں اکاؤنٹس کے درمیان منتقل نہیں کیا جا سکتا۔_

**سب ٹائٹل** - متن جو سب گراف کارڈز میں ظاہر ہوگا.

**تفصیل** - سب گراف کی تفصیل، سب گراف کی تفصیلات کے صفحہ پر دکھائی دیتی ہے.

**گٹ ہب URL** - گٹ ہب پر سب گراف ریپوزٹری سے لنک کریں.

**چھپائیں** - اسے آن کرنے سے گراف ایکسپلورر میں سب گراف چھپا جاتا ہے.

نیا سب گراف محفوظ کرنے کے بعد، آپ کو گراف CLI کو انسٹال کرنے، نئے سب گراف کے لیے سہاروں کو کیسے تیار کیا جائے، اور اپنے سب گراف کو کیسے تعینات کیا جائے اس بارے میں مدد کے ساتھ ایک اسکرین دکھائی جاتی ہے۔ پہلے دو مراحل کا احاطہ [سب گراف سیکشن کی تعریف](/developing/defining-a-subgraph) میں کیا گیا تھا.

## ہوسٹڈ سروس پر سب گراف تعینات کریں

آپ کے سب گراف کو تعینات کرنے سے وہ سب گراف فائلیں اپ لوڈ ہو جائیں گی جو آپ نے `yarn build` کے ساتھ آئی پی ایف ایس میں بنائی ہیں اور گراف ایکسپلورر کو کہیں گے کہ وہ ان فائلوں کو استعمال کرتے ہوئے اپنے سب گراف کو انڈیکس کرنا شروع کرے.

آپ `yarn deploy` چلا کر سب گراف کو تعینات کرتے ہیں

سب گراف کی تعیناتی کے بعد، گراف ایکسپلورر آپ کے سب گراف کی مطابقت پذیری کی حیثیت کو دکھانے کے لیے سوئچ کر دے گا۔ ڈیٹا کی مقدار اور واقعات کی تعداد پر منحصر ہے جنہیں تاریخی بلاکس سے نکالنے کی ضرورت ہے، جینیسس بلاک سے شروع کرتے ہوئے، مطابقت پذیری میں چند منٹ سے کئی گھنٹے لگ سکتے ہیں.

ایک بار جب گراف نوڈ تاریخی بلاکس سے تمام ڈیٹا نکال لیتا ہے تو سب گراف کی حیثیت `Synced` میں بدل جاتی ہے۔ گراف نوڈ آپ کے سب گراف کے لیے بلاکس کا معائنہ کرتا رہے گا کیونکہ ان بلاکس کی کان کنی کی گئی ہے.

## سب گراف کو دوبارہ سے تعینات کرنا

اپنے سب گراف کی تعریف میں تبدیلی کرتے وقت، مثال کے طور پر، ہستی میپنگ میں کسی مسئلے کو حل کرنے کے لیے، اپنے سب گراف کے اپ ڈیٹ شدہ ورژن کو تعینات کرنے کے لیے اوپر `yarn deploy` کمانڈ دوبارہ چلائیں۔ سب گراف کی کسی بھی اپڈیٹ کے لیے ضروری ہے کہ گراف نوڈ آپ کے پورے سب گراف کو دوبارہ ترتیب دے، دوبارہ جینیسس بلاک سے شروع ہو.

اگر آپ کا پہلے سے تعینات کردہ سب گراف اب بھی حالت میں ہے ` Syncing `، تو اسے فوری طور پر نئے تعینات کردہ ورژن سے بدل دیا جائے گا۔ اگر پہلے سے تعینات کیا گیا سب گراف پہلے سے ہی مکمل طور پر مطابقت پذیر ہے، تو گراف نوڈ نئے تعینات شدہ ورژن کو ` Pending Version ` کے بطور نشان زد کرے گا، اسے بیک گراؤنڈ میں ہم آہنگ کرے گا، اور ایک بار مطابقت پذیر ہونے کے بعد صرف موجودہ تعینات کردہ ورژن کو نئے سے بدل دے گا۔ نیا ورژن ختم ہو گیا ہے. یہ یقینی بناتا ہے کہ نیا ورژن مطابقت پذیر ہونے کے دوران آپ کے پاس کام کرنے کے لیے ایک سب گراف موجود ہے.

## سب گراف کو متعدد نیٹ ورکس پر تعینات کرنا

کچھ معاملات میں، آپ ایک ہی سب گراف کو متعدد نیٹ ورکس پر اس کے تمام کوڈ کی نقل کیے بغیر تعینات کرنا چاہیں گے۔ اس کے ساتھ آنے والا بنیادی چیلنج یہ ہے کہ ان نیٹ ورکس پر کنٹریکٹ ایڈریس مختلف ہیں.

### Graph-cli کا استعمال کرنا

دونو `graph build` (جب سے `v0.29.0`) اور `graph deploy` (جب سے `v0.32.0`) دو نئے اختیارات قبول کرتے ہیں:

```sh
اختیارات:

      ...
      --network <name>          Network configuration to use from the networks config file
      --network-file <path>     Networks config file path (default: "./networks.json")
```

آپ آسانی سے اپ ڈیٹ کرنے کے لیے ایک `json` معیاری فائل (ڈیفالٹ `networks.json`) سے نیٹ ورک کنفیگریشن کی وضاحت کرنے کے لیے `--network` ترقی کے دوران اپنے سب گراف کو آسانی سے اپ ڈیٹ کرنے کے لیے.

**نوٹ:** `init` کمانڈ اب فراہم کردہ معلومات کی بنیاد پر ایک `networks.json` خود بخود تیار کرے گی۔ اس کے بعد آپ موجودہ کو اپ ڈیٹ کرنے یا اضافی نیٹ ورکس کو شامل کرنے کے قابل ہو جائیں گے.

اگر آپ کے پاس `networks.json` فائل نہیں ہے، تو آپ کو دستی طور پر درج ذیل ڈھانچے کے ساتھ ایک فائل بنانے کی ضرورت ہوگی:

```json
{
    "network1": { // the network name
        "dataSource1": { // the dataSource name
            "address": "0xabc...", // the contract address (optional)
            "startBlock": 123456 // the startBlock (optional)
        },
        "dataSource2": {
            "address": "0x123...",
            "startBlock": 123444
        }
    },
    "network2": {
        "dataSource1": {
            "address": "0x987...",
            "startBlock": 123
        },
        "dataSource2": {
            "address": "0xxyz..",
            "startBlock": 456
        }
    },
    ...
}
```

**نوٹ:** آپ کو تشکیل فائل میں کسی بھی `templates` (اگر آپ کے پاس کوئی ہے) کی وضاحت کرنے کی ضرورت نہیں ہے، صرف ` dataSources `۔ اگر `subgraph.yaml` فائل میں کوئی بھی `templates` کا اعلان کیا گیا ہے، تو ان کا نیٹ ورک خود بخود `--network` اختیار کے ساتھ مخصوص کردہ سے اپ ڈیٹ ہوجائے گا.

اب، فرض کریں کہ آپ اپنے سب گراف کو `mainnet` اور `goerli` نیٹ ورکس پر تعینات کرنے کے قابل ہونا چاہتے ہیں، اور یہ آپ کا `subgraph.yaml` ہے:

```yaml
# ...
dataSources:
  - kind: ethereum/contract
    name: Gravity
    network: mainnet
    source:
      address: '0x123...'
      abi: Gravity
    mapping:
      kind: ethereum/events
```

آپ کے نیٹ ورکس کی تشکیل فائل کو اس طرح نظر آنا چاہئے:

```json
{
  "mainnet": {
    "Gravity": {
      "address": "0x123..."
    }
  },
  "goerli": {
    "Gravity": {
      "address": "0xabc..."
    }
  }
}
```

اب ہم زیل میں دی گئ کمانڈز میں سے ایک چلا سکتے ہیں:

```sh
# Using default networks.json file
yarn build --network goerli

# Using custom named file
yarn build --network goerli --network-file path/to/config
```

`build` کمانڈ آپ کے `subgraph.yaml` کو `goerli` کنفیگریشن کے ساتھ اپ ڈیٹ کرے گا اور پھر سب گراف کو دوبارہ مرتب کرے گا۔ آپ کی `subgraph.yaml` فائل اب اس طرح نظر آنی چاہئے:

```yaml
# ...
dataSources:
  - kind: ethereum/contract
    name: Gravity
    network: goerli
    source:
      address: '0xabc...'
      abi: Gravity
    mapping:
      kind: ethereum/events
```

اب آپ `yarn deploy` کے لیے تیار ہیں.

**نوٹ:** جیسا کہ پہلے ذکر کیا گیا ہے، `graph-cli 0.32.0` کے بعد سے آپ براہ راست `yarn deploy` کو چلا سکتے ہیں `--network` کے اختیار سے:

```sh
# Using default networks.json file
yarn deploy --network goerli

# Using custom named file
yarn deploy --network goerli --network-file path/to/config
```

### Subgraph.yaml ٹیمپلیٹ استعمال کرنا

پرانے گراف-کلی ورژن کے لیے ایک حل جو کنٹریکٹ ایڈریس جیسے پہلوؤں کو پیرامیٹرائز کرنے کی اجازت دیتا ہے یہ ہے کہ [مس ٹیش](https://mustache.github.io/) جیسے ٹیمپلیٹنگ سسٹم کا استعمال کرتے ہوئے اس کے کچھ حصے بنانا [ہینڈل بارز](https://handlebarsjs.com/).

اس نقطہ نظر کو واضح کرنے کے لیے، آئیے فرض کریں کہ مختلف کنٹریکٹ ایڈریسز کا استعمال کرتے ہوئے مین نیٹ اور گوئرلی پر ایک سب گراف تعینات کیا جانا چاہیے۔ اس کے بعد آپ ہر نیٹ ورک کے پتے فراہم کرنے والی دو کنفگ فائلوں کی وضاحت کرسکتے ہیں:

```json
{
  "network": "mainnet",
  "address": "0x123..."
}
```

اور

```json
{
  "network": "goerli",
  "address": "0xabc..."
}
```

اس کے ساتھ، آپ مینی فیسٹ میں نیٹ ورک کے نام اور پتے کو متغیر پلیس ہولڈرز `{{network}}` اور `{{address}}` سے بدل دیں گے اور مینی فیسٹ کا نام بدل کر مثال کے طور پر رکھیں گے. `subgraph.template.yaml`:

```yaml
# ...
dataSources:
  - kind: ethereum/contract
    name: Gravity
    network: mainnet
    network: {{network}}
    source:
      address: '0x2E645469f354BB4F5c8a05B3b30A929361cf77eC'
      address: '{{address}}'
      abi: Gravity
    mapping:
      kind: ethereum/events
```

کسی بھی نیٹ ورک پر مینی فیسٹ بنانے کے لیے، آپ `package.json` میں دو اضافی کمانڈز شامل کر سکتے ہیں اور ساتھ ہی ` mustache ` پر انحصار:

```json
{
  ...
  "scripts": {
    ...
    "prepare:mainnet": "mustache config/mainnet.json subgraph.template.yaml > subgraph.yaml",
    "prepare:goerli": "mustache config/goerli.json subgraph.template.yaml > subgraph.yaml"
  },
  "devDependencies": {
    ...
    "mustache": "^3.1.0"
  }
}
```

مین نیٹ یا Goerli کے لیے اس سب گراف کو تعینات کرنے کے لیے اب آپ درج ذیل دو کمانڈز میں سے ایک کو چلائیں گے:

```sh
# Mainnet:
yarn prepare:mainnet && yarn deploy

# Goerli:
yarn prepare:goerli && yarn deploy
```

اس کی عملی مثال [یہاں](https://github.com/graphprotocol/example-subgraph/tree/371232cf68e6d814facf5e5413ad0fef65144759) مل سکتی ہے.

**نوٹ:** یہ نقطہ نظر زیادہ پیچیدہ حالات پر بھی لاگو کیا جا سکتا ہے، جہاں کنٹریکٹ ایڈریسز اور نیٹ ورک کے ناموں سے زیادہ کو تبدیل کرنا ضروری ہے یا جہاں ٹیمپلیٹس سے میپنگ یا ABIs تیار کرنا بھی ضروری ہے.

## سب گراف کی صحت کی جانچ کرنا

اگر ایک سب گراف کامیابی کے ساتھ مطابقت پذیر ہوتا ہے، تو یہ ایک اچھی علامت ہے کہ یہ ہمیشہ کے لیے اچھی طرح چلتا رہے گا۔ تاہم، نیٹ ورک پر نئے محرکات آپ کے سب گراف کو بغیر جانچ کی خرابی کی حالت کو نشانہ بنا سکتے ہیں یا کارکردگی کے مسائل یا نوڈ آپریٹرز کے ساتھ مسائل کی وجہ سے یہ پیچھے پڑنا شروع کر سکتا ہے.

گراف نوڈ ایک GraphQL اختتامی نقطہ کو ظاہر کرتا ہے جس سے آپ اپنے سب گراف کی حیثیت کو چیک کرنے کے لیے کیوری کر سکتے ہیں۔ ہوسٹڈ سروس پر، یہ `https://api.thegraph.com/index-node/graphql` پر دستیاب ہے۔ مقامی نوڈ پر، یہ پورٹ `8030/graphql` پر بطور ڈیفالٹ دستیاب ہے۔ اس اختتامی نقطہ کے لیے مکمل اسکیما [یہاں](https://github.com/graphprotocol/graph-node/blob/master/server/index-node/src/schema.graphql) پایا جا سکتا ہے. یہاں ایک مثالی کیوری ہے جو سب گراف کے موجودہ ورژن کی حیثیت کو چیک کرتا ہے:

```graphql
{
  indexingStatusForCurrentVersion(subgraphName: "org/subgraph") {
    synced
    health
    fatalError {
      message
      block {
        number
        hash
      }
      handler
    }
    chains {
      chainHeadBlock {
        number
      }
      latestBlock {
        number
      }
    }
  }
}
```

اس سے آپ کو `chainHeadBlock` ملے گا جس کا موازنہ آپ اپنے سب گراف پر موجود `latestBlock` سے کر سکتے ہیں تاکہ یہ چیک کیا جا سکے کہ آیا یہ پیچھے چل رہا ہے۔ `synced` مطلع کرتا ہے کہ کیا سب گراف کبھی زنجیر تک پہنچ گیا ہے۔ `health` فی الحال `healthy` کی اقدار لے سکتا ہے اگر کوئی خرابی نہیں ہوئی، یا اگر کوئی خرابی تھی جس نے سب گراف کی پیشرفت کو روکا تو `failed`۔ اس صورت میں، آپ اس خرابی کی تفصیلات کے لیے `fatalError` فیلڈ کو چیک کر سکتے ہیں.

## ہوسٹڈ سروس سب گراف آرکائیو پالیسی

ہوسٹڈ سروس ایک مفت گراف نوڈ انڈیکسر ہے۔ ڈویلپرز نیٹ ورکس کی ایک رینج کو انڈیکس کرنے والے سب گرافس کو تعینات کر سکتے ہیں، جن کو انڈیکس کیا جاۓ گا، اور GraphQL کے ذریعے کیوری کے لیے دستیاب کرایا جائے گا.

فعال سب گراف کے لیے سروس کی کارکردگی کو بہتر بنانے کے لیے، ہوسٹڈ سروس ان سب گرافس کو محفوظ کرے گی جو غیر فعال ہیں.

**ایک سب گراف کی تعریف "غیر فعال" کے طور پر کی جاتی ہے اگر اسے ہوسٹڈ سروس میں 45 دن سے زیادہ پہلے تعینات کیا گیا تھا، اور اگر اسے پچھلے 45 دنوں میں 0 کیوریز موصول ہوئے ہوں.**

ڈیولپرز کو ای میل کے ذریعے مطلع کیا جائے گا اگر ان کے سب گراف میں سے کسی کو ہٹانے سے 7 دن پہلے غیر فعال کے طور پر نشان زد کیا گیا ہو۔ اگر وہ اپنے سب گراف کو "فعال" کرنا چاہتے ہیں، تو وہ اپنے سب گراف کی ہوسٹڈ سروس گراف کیو ایل پلے گراؤنڈ میں کیوری کر کے ایسا کر سکتے ہیں۔ اگر دوبارہ ضرورت ہو تو ڈویلپرز ہمیشہ محفوظ شدہ سب گراف کو دوبارہ تعینات کر سکتے ہیں.

## سب گراف سٹوڈیو سب گراف آرکائیو پالیسی

جب سب گراف کا نیا ورژن تعینات کیا جاتا ہے، تو پچھلا ورژن محفوظ کیا جاتا ہے (گراف نوڈ DB سے حذف کیا جاتا ہے)۔ یہ صرف اس صورت میں ہوتا ہے جب پچھلا ورژن دی گراف کے ڈیسینٹرالائزڈ نیٹ ورک پر شائع نہ کیا گیا ہو.

جب کسی سب گراف ورژن سے 45 دنوں سے زیادہ کے لیے کیوری نہیں کیا جاتا ہے، تو اس ورژن کو محفوظ کر لیا جاتا ہے.

اس پالیسی سے متاثر ہونے والے ہر سب گراف کے پاس زیر بحث ورژن کو واپس لانے کا اختیار ہے.
