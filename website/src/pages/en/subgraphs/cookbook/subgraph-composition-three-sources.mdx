---
title: Integrating Three Subgraphs Using Subgraph Composition
sidebarTitle: 'Composable Subgraph with Three Source Subgraphs'
---

Optimize your Subgraph by merging data from three independent, `source` Subgraphs into a single composable Subgraph to enhance data aggregation.

> Important Reminders

> - Subgraph composition is built into the CLI, and you can deploy with [Subgraph Studio](https://thegraph.com/studio/).
> - This feature requires spec version 1.3.0.

## Overview

Subgraph composition empowers developer to leverage a Subgraph with other Subgraphs as data sources, seamlessly integrating and reacting to data updates and entity changes. This capability enhances efficiency and responsiveness in data handling.

## Prerequisites

To deploy **all** Subgraphs locally, you must have the following:

- A [graph-node](https://github.com/graphprotocol/graph-node) instance running locally
- An [IPFS](https://docs.ipfs.tech/) instance running locally
- [Node.js.](https://nodejs.org/en) and npm

## Get Started

The following guide provides examples for defining three `source` Subgraphs to create one powerful composed Subgraph.

### Specifics

- To keep this example simple, all `source` subgraphs use only block handlers, but in a real environment, each source Subgraph will use data from different smart contracts.
- The examples below show how to import and extend the schema of another Subgraph to enhance its functionality.
- Each source Subgraph is optimized with a specific entity.
- All the commands listed install the necessary dependencies, generate code based on the GraphQL schema, build the Subgraph, and deploy it to your local Graph Node instance.

### Step 1. Deploy Block Time Source Subgraph

This first source Subgraph calculates the block time for each block.

- It imports schemas from other Subgraphs and adds a `block` entity with a `timestamp` field, representing the time each block was mined.
- It listens to time-related blockchain events (e.g., block timestamps) and processes this data to update the Subgraph's entities accordingly.

To deploy this Subgraph locally, run the following commands:

```bash
npm install
npm run codegen
npm run build
npm run create-local
npm run deploy-local
```

### Step 1. Deploy Block Cost Source Subgraph

This second `source` Subgraph indexes the cost of each block.

#### Key Functions

- It imports schemas from other Subgraphs and adds a `block` entity with cost-related fields.
- It listens to blockchain events related to costs (e.g. gas fees, transaction costs) and processes this data to update the Subgraph's entities accordingly.

To deploy this Subgraph locally, run the following commands:

```bash
npm install
npm run codegen
npm run build
npm run create-local
npm run deploy-local
```

### Step 2. Define Block Size in Source Subgraph

This third `source` Subgraph indexes the size of each block.

#### Key Functions

- It imports existing schemas from other Subgraphs and adds a `Block` entity with a `size` field representing each block's size.
- It listens to blockchain events related to block sizes (e.g., storage or volume) and processes this data to update the Subgraph's entities accordingly.

To deploy this Subgraph locally, run the following commands:

```bash
npm install
npm run codegen
npm run build
npm run create-local
npm run deploy-local
```

### Step 3. Combine Into Block Stats Subgraph

This composed Subgraph combines and aggregates the information from the three source Subgraphs above.

> [!NOTE] Any change to a source Subgraph will likely generate a new deployment ID. Be sure to update the deployment ID in the data source address of the Subgraph manifest to take advantage of the latest changes. [!IMPORTANT] All source Subgraphs should be deployed before the composed Subgraph is deployed.

This composed Subgraph demonstrates how to create a subgraph that aggregates data from three source subgraphs, providing a unified, enhanced view of block statistics.

#### Key Functions

- It provides a consolidated data model that encompasses all relevant block metrics.
- It combines data from three `source` subgraphs, and provides a comprehensive view of block statistics, enabling more complex queries and analyses. To deploy this subgraph locally, run the following commands:

```bash
npm install
npm run codegen
npm run build
npm run create-local
npm run deploy-local
```

## Key Takeaways

- This powerful tool will scale your subgraph development and allow you to combine multiple Subgraphs.
- The setup includes the deployment of three source Subgraphs and one final deployment of the composed Subgraph.
- This feature unlocks scalability, simplifying both development and maintenance efficiency.

## Additional Resources

- Add advanced features in your subgraph. Check out [subgraph advance features](/developing/creating/advanced/) and the [subgraph composition repo](https://github.com/incrypto32/subgraph-composition-sample-subgraph).
- Check out the Github repo [for this example] (https://github.com/isum/subgraph-composition-example).
