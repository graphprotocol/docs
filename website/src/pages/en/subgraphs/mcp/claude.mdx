---
title: Claude
---

## Using Claude Desktop to Access Subgraphs via MCP

The Subgraph Model Context Protocol (MCP) server enables Claude to interact directly with subgraphs on The Graph Network. This integration allows you to explore subgraph schemas, execute GraphQL queries, and find relevant subgraphs for specific contractsâ€”all through natural language conversations with Claude.

### What You Can Do

With the Subgraph MCP integration, you can:

- Access the GraphQL schema for any subgraph on The Graph Network
- Execute GraphQL queries against any subgraph deployment
- Find top subgraph deployments for a contract address on a specific chain
- Ask natural language questions about subgraph data without writing GraphQL queries manually

### Requirements

Before setting up the Subgraph MCP server, make sure you have:

- **Claude Desktop**: Latest version installed
- **Rust**: Latest stable version (1.75+)
- **Gateway API key**: An API key from The Graph Network

## Installation

### Step 1: Install Rust (if not already installed)

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

Follow the on-screen instructions. For other platforms, see the [official Rust installation guide](https://www.rust-lang.org/tools/install).

### Step 2: Install the Subgraph MCP Server

```bash
# Clone the repository
git clone git@github.com:graphops/subgraph-mcp.git
cd subgraph-mcp

# Build the project
cargo build --release
```

### Step 3: Get your Gateway API Key

You'll need an API key from [Subgraph Studio](https://thegraph.com/studio/) to authenticate requests to The Graph Network.

## Configuration

### Configure Claude Desktop

1. Open Claude Desktop and click on the top left corner to access Settings
2. Add the Subgraph MCP server to your `claude_desktop_config.json`

Here's how to set up your configuration:

```json
{
  "mcpServers": {
    "subgraph": {
      "command": "/path/to/your/subgraph-mcp/target/release/subgraph-mcp",
      "env": {
        "GATEWAY_API_KEY": "your-api-key-here"
      }
    }
  }
}
```

#### Finding the Command Path

After building the project, you need to specify the absolute path to the compiled binary:

1. Navigate to your `subgraph-mcp` directory in the terminal
2. Run `pwd` to get the full path to the directory
3. Add `/target/release/subgraph-mcp` to that path

For example, if `pwd` outputs `/Users/username/subgraph-mcp`, your full command path would be: `/Users/username/subgraph-mcp/target/release/subgraph-mcp`

### Troubleshooting Installation

If you encounter issues with the setup:

1. Clean any existing build and rebuild:

   ```bash
   cd subgraph-mcp
   cargo clean
   cargo build --release
   ```

2. Ensure the executable has proper permissions:
   ```bash
   chmod +x target/release/subgraph-mcp
   ```

## Using The Graph Resource in Claude

After configuring Claude Desktop:

1. Restart Claude Desktop
2. Start a new conversation
3. Click on the context menu (top right)
4. Add "The Graph" resource by adding `graphql://subgraph` to your chat context

**Important**: Claude Desktop may not automatically utilize the Subgraph MCP. You must manually add "The Graph" resource to your chat context for each conversation where you want to use it.

## Available Tools and Usage

The Subgraph MCP provides several tools for interacting with subgraphs:

### Schema Retrieval Tools

- **Get schema by deployment ID**: Access the GraphQL schema using a deployment ID (0x...)
- **Get schema by subgraph ID**: Access the schema for the current deployment of a subgraph (5zvR82...)
- **Get schema by IPFS hash**: Access the schema using a subgraph's IPFS manifest hash (Qm...)

### Query Execution Tools

- **Execute query by deployment ID**: Run GraphQL queries against specific, immutable deployments
- **Execute query by subgraph ID**: Run GraphQL queries against the latest version of a subgraph

### Discovery Tools

- **Get top subgraph deployments**: Find the top 3 subgraph deployments indexing a specific contract on a particular chain

## Natural Language Queries

One of the most powerful features of the Subgraph MCP integration is the ability to ask questions in natural language. Claude will:

1. Understand your goal (lookup, find subgraphs, query, get schema)
2. Find relevant deployments if needed
3. Fetch and interpret the subgraph schema
4. Convert your question into an appropriate GraphQL query
5. Execute the query and present the results in a readable format

### Example Natural Language Queries

```
What are the pairs with maximum volume on 0xde0a7b5368f846f7d863d9f64949b688ad9818243151d488b4c6b206145b9ea3?

Which tokens have the highest market cap in this subgraph?

Show me the most recent 5 swaps for the USDC/ETH pair
```

## Using Both Token API MCP and Subgraph MCP Together

You can configure Claude Desktop to use both the Token API MCP and Subgraph MCP simultaneously:

```json
{
  "mcpServers": {
    "token-api": {
      "command": "path-to-bunx",
      "args": ["@pinax/mcp", "--sse-url", "https://token-api.thegraph.com/sse"],
      "env": {
        "ACCESS_TOKEN": "access-token-from-graph-market"
      }
    },
    "subgraph": {
      "command": "/path/to/subgraph-mcp/target/release/subgraph-mcp",
      "env": {
        "GATEWAY_API_KEY": "api-key-from-subgraph-studio"
      }
    }
  }
}
```

For Token API access tokens, visit [The Graph Market](https://thegraph.com/explorer). For Subgraph Gateway API keys, visit [Subgraph Studio](https://thegraph.com/studio/).

## Key Identifier Types

When working with subgraphs, you'll encounter different types of identifiers:

- **Subgraph ID** (e.g., `5zvR82...`): Logical identifier for a subgraph
- **Deployment ID** (e.g., `0x4d7c...`): Identifier for a specific, immutable deployment
- **IPFS Hash** (e.g., `QmTZ8e...`): Identifier for the manifest of a specific deployment

## Example Interactions

Here are some examples of how you can interact with Claude once the Subgraph MCP is set up:

```
Get the schema for subgraph deployment 0xYourDeploymentIdHere

Run this query against subgraph 5zvR82YourSubgraphIdHere: { users(first: 1) { id } }

Find the top subgraphs for contract 0x1f98431c8ad98523631ae4a59f267346ea31f984 on arbitrum-one
```

## Additional Resources

- [The Graph Documentation](https://thegraph.com/docs/)
- [Subgraph MCP GitHub Repository](https://github.com/graphops/subgraph-mcp)
- [Token API MCP Documentation](https://thegraph.com/docs/en/token-api/mcp/claude/)
