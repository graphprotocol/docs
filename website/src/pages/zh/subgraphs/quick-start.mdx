---
title: 快速开始
---

Learn how to easily build, publish and query a [Subgraph](/subgraphs/developing/developer-faq/#1-what-is-a-subgraph) on The Graph.

## 先决条件

- 一个加密钱包
- A smart contract address on a [supported network](/supported-networks/)
- [Node.js](https://nodejs.org/) installed
- A package manager of your choice (`npm`, `yarn` or `pnpm`)

## 如何构建子图

### 1. 在子图工作室中创建子图

进入[Subgraph Studio](https://thegraph.com/studio/)并连接你的钱包。

子图工作室可以让您创建、管理、部署和发布子图，以及创建和管理 API 密钥。

点击“创建子图”。建议在标题大小写中为子图命名：“子图名称链名称”。

### 2. 安装 Graph CLI

在本地计算机上，运行以下命令之一：

使用[npm](https://www.npmjs.com/)：

```sh
npm install -g @graphprotocol/graph-cli@latest
```

Using [yarn](https://yarnpkg.com/):

```sh
yarn global add @graphprotocol/graph-cli
```

### 3. 初始化子图

> 您可以在[Subgraph Studio](https://thegraph.com/studio/)的子图页面找到针对您特定子图的命令。

`graph init`命令将根据你的合约事件自动创建一个子图的手写。

以下命令从现有合约初始化你的子图：

```sh
graph init
```

如果您的合约已经在部署的相应拦截扫描仪上进行了验证(例如 [Etherscan](https://etherscan.io/))， 那么自动在 CLI 中创建 ABI 。

初始化子图时，CLI工具会要求您提供以下信息：

- **协议**：选择子图将要索引数据的协议。
- **子图slug**: 为你的子图创建一个名称。子图slug是你的子图的标识符。
- **Directory**：选择一个目录来创建你的子图。
- **Etherum网络** (可选)：您可能需要指定您的子图将索引数据来自哪个EVM兼容网络。
- **合约地址**：找到要查询数据的智能合约地址。
- **ABI**：如果ABI没有自动填充，您需要手动输入JSON文件。
- **启动Block**：您应该输入起始区块以优化区块链数据的子图索引。 通过找到您的合约部署所在的区块来定位起始区块。
- **合约名称**：输入合约名称。
- **将合约事件作为实体索引**：建议您将其设置为真。 因为它会自动将映射添加到你的子图中。
- **添加其他合约**（可选）：您可以添加其他合约。

请参阅下面的屏幕截图，以获取初始化子图时所需的示例：

![Subgraph command](/img/CLI-Example.png)

### 4. 编写子图

上一步的 `init` 命令创建了一个可以用作构建Subgraph起点的 scaffold 子图。

在对子图进行修改时，你将主要与三个文件一起工作：

- 清单（`subgraph.yaml`）--该清单定义了你的子图将索引哪些数据源。
- 模式（`schema.graphql`）--定义你希望从子图中检索到的数据。
- AssemblyScript 映射（`mapping.ts`）--将数据源中的数据转换为模式中定义的实体的代码。

想了解更多如何编写子图的信息，请参阅[创建子图](/developing/creating-a-subgraph/)。

### 5. 部署子图

> 记住，部署与发布不同。

当你**部署**一个Subgraph时，你将它推送到[Subgraph Studio](https://thegraph.com/studio/)，在那里你可以测试、分段和查看它。 已部署的子图索引由 [升级索引人](https://thegraph.com/blog/upgrade-indexer/) 执行。 这是一个由Edge & Node拥有和操作的单一索引人，而不是由The Graph网络中许多去中心化的索引人拥有和操作的。 **部署** 子图可自由使用，频率限制，公众看不到，并可用于开发、分阶段和测试。

一旦您的子图被编写好，请运行以下命令：

````
```sh
graph codegen && graph build
```
````

认证并部署子图。部署密钥可以在子图工作室的子图页面上找到。

![部署密钥](/img/subgraph-studio-deploy-key.jpg)

````
```sh

graph auth <DEPLOY_KEY>

graph deploy <SUBGRAPH_SLUG>
```
````

CLI 将要求一个版本标签。强烈建议使用 [语义版本](https://semver.org/)，例如`0.0.1`。

### 6. 审查子图

如果你想在发布之前测试你的子图，你可以使用 [Subgraph Studio](https://thegraph.com/studio/) 来执行以下操作：

- 运行一个示例查询。
- 在仪表盘分析您的子图以检查信息。
- 检查仪表盘上的日志，以查看您的子图表是否有任何错误。 操作子图的日志将看起来像这样：

  ![Subgraph logs](/img/subgraph-logs-image.png)

### 7. 将你的子图发布到 The Graph的去中心化网络

当你的子图准备好生产环境时，你可以将它发布到去中心化的网络。 发布是一种在线操作，可以做以下工作：

- 使您的子图可以被去中心化的 [索引人](/indexing/overview/)索引到The Graph网络。
- 取消了费率限制，使你的子图可以公开搜索并可以在 [Graph Explorer](https://thegraph.com/explorer/) 中查询。
- 使您的子图可供 [策展人](/resources/roles/curating/)进行策展。

> 您和其他人在您的子图上策展的GRT数量越多，索引人将会更多地被激励来索引您的子图， 提高服务质量，降低延迟性，并提高子图的网络冗余性。

#### Publishing with Subgraph Studio

To publish your Subgraph, click the Publish button in the dashboard.

![Publish a Subgraph on Subgraph Studio](/img/publish-sub-transfer.png)

Select the network to which you would like to publish your Subgraph.

#### 从 CLI 发布

As of version 0.73.0, you can also publish your Subgraph with the Graph CLI.

打开 `graph-cli`。

Use the following commands:

````
```sh
graph codegen && graph build
```

Then,

```sh
graph publish
```
````

3. 一个窗口将打开，允许您连接您的钱包，添加元数据，并将您的最终子图部署到您选择的网络。

![cli-ui](/img/cli-ui.png)

To customize your deployment, see [Publishing a Subgraph](/subgraphs/developing/publishing/publishing-a-subgraph/).

#### 将信号添加到您的子图

1. To attract Indexers to query your Subgraph, you should add GRT curation signal to it.

   - This action improves quality of service, reduces latency, and enhances network redundancy and availability for your Subgraph.

2. If eligible for indexing rewards, Indexers receive GRT rewards based on the signaled amount.

   - It’s recommended to curate at least 3,000 GRT to attract 3 Indexers. Check reward eligibility based on Subgraph feature usage and supported networks.

To learn more about curation, read [Curating](/resources/roles/curating/).

To save on gas costs, you can curate your Subgraph in the same transaction you publish it by selecting this option:

![Subgraph publish](/img/studio-publish-modal.png)

### 8. Query your Subgraph

You now have access to 100,000 free queries per month with your Subgraph on The Graph Network!

You can query your Subgraph by sending GraphQL queries to its Query URL, which you can find by clicking the Query button.

For more information about querying data from your Subgraph, read [Querying The Graph](/subgraphs/querying/introduction/).
