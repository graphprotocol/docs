---
title: Subgraph Studioの使い方
---

新しいローンチパッドへようこそ👩🏽‍🚀

Subgraph Studioは、サブグラフを構築・作成し、メタデータを追加して、新しい分散型エクスプローラーに公開するための場所です（詳細は[こちら](/explorer)）

Subgraph Studioでできること

- Studio UIによるサブグラフの作成
- CLIを使用したサブグラフのデプロイ
- Studio UIでサブグラフを公開する
- プレイグラウンドでのテスト
- クエリURLを使用してステージングに統合する
- 特定のサブグラフ用のAPIキーの作成と管理

Subgraph Studioでは、サブグラフを完全にコントロールすることができます。サブグラフを公開する前にテストできるだけでなく、APIキーを特定のドメインに限定したり、特定のインデクサにAPIキーからのクエリを許可したりすることもできます。

サブグラフへのクエリはクエリフィーを発生させ、グラフネットワーク上の[インデクサー](/indexing)への報酬とします。dappの開発者やサブグラフの開発者は、このStudioを利用することで、より優れたサブグラフを構築し、自分やコミュニティのクエリを強化することができます。Studioは5つの主要部分で構成されています。

- ユーザーアカウントの管理
- 作成したサブグラフのリスト
- 特定のサブグラフのステータスを管理、詳細表示、視覚化するセクション
- サブグラフのクエリに必要なAPIキーを管理するセクション
- 請求書を管理するためのセクション

## アカウントの作成方法

1. お使いのウォレットでサインインします - MetaMaskまたはWalletConnectで行うことができます。
1. サインインすると、アカウントのホームページに固有のデプロイキーが表示されます。これにより、サブグラフの公開やAPIキーと課金の管理を行うことができます。固有のデプロイキーは、漏洩したと思われる場合に再生成することができます。

## Subgraph Studioでサブグラフを作成する方法

一番のポイントです - 最初にサブグラフを作成する際には、以下の項目を入力するように指示されます:

- サブグラフネーム
- 画像
- 説明
- カテゴリー
- ウェブサイト

## SubgraphとThe Graph Networkの互換性

The Graph Networkは、Hosted Serviceで利用可能なデータソースや機能のすべてに対応しているわけではありません。ネットワーク上のインデクサでサポートされるためには、サブグラフは以下の条件を満たす必要があります。

- メインネットEthereumのインデックス
- 以下の機能のいずれも使用してはいけません:
  - ipfs.cat & ipfs.map
  - Non-fatal errors
  - Grafting

The Graph Networkの機能やネットワークは順次追加されていきます。

### サブグラフのライフサイクルフロー

![サブグラフのライフサイクル](/img/subgraph-lifecycle.png)

サブグラフを作成した後は、[CLI](https://github.com/graphprotocol/graph-cli)（コマンドライン・インターフェース）を使ってデプロイすることができます。CLIでサブグラフをデプロイすると、そのサブグラフがStudioにプッシュされ、プレイグラウンドを使ってサブグラフをテストすることができます。これにより、最終的にはGraph Networkへの公開が可能になります。CLIセットアップの詳細については、[こちら](/developer/define-subgraph-hosted#install-the-graph-cli)をご覧ください（pst、デプロイキーが手元にあることを確認してください）。なお、デプロイと公開は**同じではありません**。サブグラフをデプロイすると、それをスタジオにプッシュしてテストすることができます。一方、サブグラフを公開する場合は、オンチェーンで公開します。

## Subgraph Studioでのサブグラフのテスト

ネットワークに公開する前にサブグラフをテストしたい場合、Subgraph **Playground**でこれを行うか、ログを見ることができます。Subgraphのログは、サブグラフが失敗した場合に、**どこで**失敗したかを教えてくれます。

## Subgraph Studioでサブグラフを公開する

ここまで来ました - おめでとうございます。サブグラフの公開とは、CLI内でサブグラフを展開した際にIPFSハッシュが生成され、ネットワークのEthereumスマートコントラクトに保存されることを意味します。サブグラフの公開を成功させるためには、この[ブログ](https://thegraph.com/blog/building-with-subgraph-studio)で紹介している以下のステップを踏む必要があります。以下のビデオ概要もチェックしてみてください。

<figure className="video-container">
  <iframe
    className="video-iframe"
    src="https://www.youtube.com/embed/HfDgC2oNnwo"
    title="YouTube ビデオプレイヤー"
    frameBorder="0"
    allowFullScreen
></iframe>
</figure>

公開する際には、メインネットまたはテストネットであるRinkebyのどちらかに公開することができます。初めてサブグラフを開発される方は、まずRinkebyへの公開から始めることをお勧めします。これにより、サブグラフがThe Graph Explorerでどのように動作するかを確認することができ、キュレーション要素をテストすることができます。

メインネットのデータをインデックス化しているサブグラフのみがネットワークに公開できるため、メインネットからのデータのみをインデックス化することができます（サブグラフがテストネットに公開されていたとしても）。これは、インデクサが特定のブロック・ハッシュの時点で必須のProof of Indexingレコードを提出する必要があるためです。サブグラフの公開はオンチェーンで行われるアクションであるため、トランザクションの実行には最大で数分かかることを覚えておいてください。コントラクトの公開に使用したアドレスは、将来のバージョンを公開できる唯一のアドレスとなります。賢い選択をしましょう

キュレーションシグナルを持つサブグラフは、分散型ネットワーク上でインデックスを作成できるようにインデクサーに表示されます。サブグラフとシグナルを1つのトランザクションで公開できるので、サブグラフの最初のキュレーションシグナルをミントすることができ、ガス代を節約することができます。また、キュレーターが後から提供するシグナルに自分のシグナルを加えることで、自分のサブグラフが最終的にクエリを提供する確率が高くなります。

**サブグラフの公開が完了したところで、次にサブグラフの定期的な管理方法について説明します。**同期に失敗したサブグラフは、ネットワークに公開できないことに注意してください。これは通常、サブグラフにバグがあるためで、ログを見ればどこに問題があるかがわかります。

## CLIによるサブグラフのバージョン管理

開発者は、さまざまな理由でサブグラフを更新したい場合があります。このような場合、CLIを使用してスタジオにサブグラフの新バージョンをデプロイし（この時点ではプライベートのみ）、新しいデプロイメントをThe Graph Explorerに公開することができます。これにより、サブグラフの新しいバージョンが作成され、キュレーターはシグナリングを開始することができ、インデクサはこの新しいバージョンにインデックスを付けることができます。

最近まで、開発者はサブグラフのメタデータを更新するために、サブグラフの新バージョンをデプロイして「The Graph Explorer」に公開する必要がありました。今回、開発者は**新バージョンを公開することなく****、サブグラフのメタデータを更新できるようになりました。開発者は、スタジオで「Update Details in The Graph Explorer」というオプションをチェックすることで、自分のサブグラフの**詳細（プロフィール画像、名前、説明など）を更新することができます。これがチェックされると、オンチェーンのトランザクションが生成され、新しいデプロイメントで新しいバージョンを公開しなくても、エクスプローラーのサブグラフの詳細が更新されます。

なお、サブグラフの新バージョンをネットワークに公開する際には、コストがかかります。トランザクション手数料に加えて、開発者は自動移行するシグナルにかかるキュレーション税の一部を賄う必要があります。キュレーターがシグナルを出していない場合、サブグラフの新バージョンを公開することはできません。キュレーションのリスクについて、詳しくは[こちら](/curating)をご覧ください。

### サブグラフのバージョンの自動アーカイブ

Subgraph Studioで新しいサブグラフのバージョンを展開すると、以前のバージョンがアーカイブされます。アーカイブされたバージョンはインデックス/同期されず、したがってクエリできません。Studio UIでサブグラフのアーカイブされたバージョンをアンアーカイブすることができます。スタジオにデプロイされた非公開のサブグラフの前のバージョンは、自動的にアーカイブされることに注意してください。

![Subgraph Studio - Unarchive](/img/Unarchive.png)

## APIキーの管理

Dapp開発者、サブグラフ開発者に関わらず、APIキーを管理する必要があります。APIキーは、アプリケーションサービス間の接続が有効で認証されていることを確認するため、サブグラフを照会できるようにするために重要です。これには、アプリケーションを使用するエンドユーザとデバイスの認証が含まれます。

スタジオでは、既存の API キーがリストアップされ、管理や削除が可能になります。

1. **Overview**セクションでは、以下のことができます:
   - キー名の編集
   - APIキーの再生成
   - API キーの現在の使用状況を統計で表示:
     - クエリの数
     - 使用したGRTの量
2. **Manage Security Settings**では、APIキーの管理レベルに応じて、セキュリティ設定を選択することができます。このセクションでは、以下のことができます:
   - APIキーの使用を許可されたドメイン名の表示と管理
   - APIキーでクエリ可能なサブグラフの割り当て

## サブグラフの管理方法

APIキー以外にも、サブグラフを管理するための様々なツールが用意されています。サブグラフは、**ステータス**や**カテゴリー**ごとに整理することができます。

- **Status**タグでは、`<created>`, `<deployed>`, `<published>`, `<archived>`など、さまざまなタグを選択できます。
- 一方、**Category**では、サブグラフがどのようなカテゴリーに分類されるかを指定できます。オプションには、`<DeFi>`, `<NFTs>`, `<Governance>`などがあります。
