---
title: 介绍
---

本页将解释什么是The Graph，以及你如何开始。

## 什么是The Graph

The Graph is a decentralized protocol for indexing and querying data from blockchains, starting with Ethereum. It makes it possible to query data that is difficult to query directly. 它使查询那些难以直接查询的数据成为可能。

像 [Uniswap](https://uniswap.org/)这样具有复杂智能合约的项目，以及像 [Bored Ape Yacht Club](https://boredapeyachtclub.com/) 这样的NFTs倡议，都在以太坊区块链上存储数据，因此，除了直接从区块链上读取基本数据外，真的很难。

In the case of Bored Ape Yacht Club, we can perform basic read operations on [the contract](https://etherscan.io/address/0xbc4ca0eda7647a8ab7c2061c2e118a18a936f13d#code) like getting the owner of a certain Ape, getting the content URI of an Ape based on their ID, or the total supply, as these read operations are programmed directly into the smart contract, but more advanced real-world queries and operations like aggregation, search, relationships, and non-trivial filtering are not possible. For example, if we wanted to query for apes that are owned by a certain address, and filter by one of its characteristics, we would not be able to get that information by interacting directly with the contract itself. 例如，如果我们想查询某个地址所拥有的apes，并通过它的某个特征进行过滤，我们将无法通过直接与合约本身进行交互来获得该信息。

To get this data, you would have to process every single [`transfer`](https://etherscan.io/address/0xbc4ca0eda7647a8ab7c2061c2e118a18a936f13d#code#L1746) event ever emitted, read the metadata from IPFS using the Token ID and IPFS hash, and then aggregate it. Even for these types of relatively simple questions, it would take **hours or even days** for a decentralized application (dapp) running in a browser to get an answer. 即使是这些类型的相对简单的问题，在浏览器中运行的去中心化应用程序（dapp）也需要**几个小时甚至几天** 才能得到答案。

You could also build out your own server, process the transactions there, save them to a database, and build an API endpoint on top of it all in order to query the data. However, this option is resource intensive, needs maintenance, presents a single point of failure, and breaks important security properties required for decentralization. 然而，这种选择是资源密集型的，需要维护，会出现单点故障，并破坏了去中心化化所需的重要安全属性。

**为区块链数据编制索引真的非常非常难。**

区块链的属性，如最终性、链重组或未封闭的区块，使这一过程进一步复杂化，并使从区块链数据中检索出正确的查询结果不仅耗时，而且在概念上也很难。

The Graph solves this with a decentralized protocol that indexes and enables the performant and efficient querying of blockchain data. These APIs (indexed "subgraphs") can then be queried with a standard GraphQL API. Today, there is a hosted service as well as a decentralized protocol with the same capabilities. Both are backed by the open source implementation of [Graph Node](https://github.com/graphprotocol/graph-node). 这些API（索引的 "子图"）然后可以用标准的GraphQL API进行查询。 今天，有一个托管服务，也有一个具有相同功能的分去中心化协议。 两者都由 [](https://github.com/graphprotocol/graph-node)Graph Node

的开放源码实现支持。</p> 



## The Graph是如何工作的

The Graph learns what and how to index Ethereum data based on subgraph descriptions, known as the subgraph manifest. The subgraph description defines the smart contracts of interest for a subgraph, the events in those contracts to pay attention to, and how to map event data to data that The Graph will store in its database. 子图描述定义了子图所关注的智能合约，这些合约中需要关注的事件，以及如何将事件数据映射到The Graph将存储在其数据库中的数据。

一旦你写好了 `子图清单 `，你就可以使用Graph CLI将该定义存储在IPFS中，并告诉索引人开始为该子图编制索引数据。

这张图更详细地介绍了一旦部署了子图清单，处理以太坊交易的数据流。

![](/img/graph-dataflow.png)

流程遵循这些步骤：

1. 一个去中心化的应用程序通过智能合约上的交易向以太坊添加数据。
2. 智能合约在处理交易时，会发出一个或多个事件。
3. Graph节点不断扫描以太坊的新区块和它们可能包含的子图的数据。
4. Graph 节点在这些区块中为你的子图找到Ethereum事件并运行你提供的映射处理程序。 Graph Node finds Ethereum events for your subgraph in these blocks and runs the mapping handlers you provided. The mapping is a WASM module that creates or updates the data entities that Graph Node stores in response to Ethereum events.
5. The decentralized application queries the Graph Node for data indexed from the blockchain, using the node's [GraphQL endpoint](https://graphql.org/learn/). The Graph Node in turn translates the GraphQL queries into queries for its underlying data store in order to fetch this data, making use of the store's indexing capabilities. The decentralized application displays this data in a rich UI for end-users, which they use to issue new transactions on Ethereum. The cycle repeats. Graph节点反过来将GraphQL查询转化为对其底层数据存储的查询，以便利用存储的索引功能来获取这些数据。 去中心化的应用程序在一个丰富的用户界面中为终端用户显示这些数据，他们用这些数据在以太坊上发行新的交易。 就这样周而复始。



## 下一步

在下面的章节中，我们将更详细地介绍如何定义子图，如何部署它们，以及如何从Graph 节点建立的索引中查询数据。

在你开始编写你自己的子图之前，你可能想看一下Graph浏览器，探索一些已经部署的子图。 Before you start writing your own subgraph, you might want to have a look at the Graph Explorer and explore some of the subgraphs that have already been deployed. The page for each subgraph contains a playground that lets you query that subgraph's data with GraphQL.
